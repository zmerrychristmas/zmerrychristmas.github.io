<!doctype html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="Tạo Rails API với Grape" /><meta name="author" content="Leo đẹp trai" /><meta property="og:locale" content="en_US" /><meta name="description" content="Trong việc module hóa cũng như tạo cấu trúc REST API bạn có thể tự tạo cho mình một framework riêng hoặc sử dụng một framework đã có và đang được phát triển và ưa dùng là grape. tham khảo tại đây Grape api là gì ? Grape is a REST-like API framework for Ruby. It&#39;s designed to run on Rack or complement existing web application frameworks such as Rails and Sinatra by providing a simple DSL to easily develop RESTful APIs. It has built-in support for common conventions, including multiple formats, subdomain/prefix restriction, content negotiation, versioning and much more. api frame work Restful Apis Rack, Sinatra support built-in support" /><meta property="og:description" content="Trong việc module hóa cũng như tạo cấu trúc REST API bạn có thể tự tạo cho mình một framework riêng hoặc sử dụng một framework đã có và đang được phát triển và ưa dùng là grape. tham khảo tại đây Grape api là gì ? Grape is a REST-like API framework for Ruby. It&#39;s designed to run on Rack or complement existing web application frameworks such as Rails and Sinatra by providing a simple DSL to easily develop RESTful APIs. It has built-in support for common conventions, including multiple formats, subdomain/prefix restriction, content negotiation, versioning and much more. api frame work Restful Apis Rack, Sinatra support built-in support" /><link rel="canonical" href="https://zmerrychristmas.github.io/posts/Tao-rails-api-voi-grape/" /><meta property="og:url" content="https://zmerrychristmas.github.io/posts/Tao-rails-api-voi-grape/" /><meta property="og:site_name" content="Programmer From Zero To Mountaint" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-03-22T00:00:00+07:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Tạo Rails API với Grape" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@Leo đẹp trai" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Leo đẹp trai"},"dateModified":"2024-02-04T17:55:43+07:00","datePublished":"2021-03-22T00:00:00+07:00","description":"Trong việc module hóa cũng như tạo cấu trúc REST API bạn có thể tự tạo cho mình một framework riêng hoặc sử dụng một framework đã có và đang được phát triển và ưa dùng là grape. tham khảo tại đây Grape api là gì ? Grape is a REST-like API framework for Ruby. It&#39;s designed to run on Rack or complement existing web application frameworks such as Rails and Sinatra by providing a simple DSL to easily develop RESTful APIs. It has built-in support for common conventions, including multiple formats, subdomain/prefix restriction, content negotiation, versioning and much more. api frame work Restful Apis Rack, Sinatra support built-in support","headline":"Tạo Rails API với Grape","mainEntityOfPage":{"@type":"WebPage","@id":"https://zmerrychristmas.github.io/posts/Tao-rails-api-voi-grape/"},"url":"https://zmerrychristmas.github.io/posts/Tao-rails-api-voi-grape/"}</script><meta name="pwa-cache" content="true"><title>Tạo Rails API với Grape | Programmer From Zero To Mountaint</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Programmer From Zero To Mountaint"><meta name="application-name" content="Programmer From Zero To Mountaint"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="preconnect" href="https://polyfill.io" ><link rel="dns-prefetch" href="https://polyfill.io" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.25.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return 'mode'; } static get MODE_ATTR() { return 'data-mode'; } static get DARK_MODE() { return 'dark'; } static get LIGHT_MODE() { return 'light'; } static get ID() { return 'mode-toggle'; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia('(prefers-color-scheme: dark)'); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { document.documentElement.removeAttribute(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage( { direction: ModeToggle.ID, message: this.modeStatus }, '*' ); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.notify(); } /* flipMode() */ } /* ModeToggle */ const modeToggle = new ModeToggle(); </script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/portfolio/assets/img/portfolio/leo/horse-racing.webp" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a><h1 class="site-title"> <a href="/">Programmer From Zero To Mountaint</a></h1><p class="site-subtitle fst-italic mb-0">Programmer blog</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/portfoio/" class="nav-link"> <i class="fa-fw fas fa-paper-plane"></i> <span>PORTFOLIO</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/zmerrychristmas" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fa-brands fa-x-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['huybinh.ad','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a> <a href="https://www.linkedin.com/in/b%C3%ACnh-nguy%E1%BB%85n-75312a7b/" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Tạo Rails API với Grape</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1"><header><h1 data-toc-skip>Tạo Rails API với Grape</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1616346000" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Mar 22, 2021 </time> </span> <span> Updated <time data-ts="1707044143" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Feb 4, 2024 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/username">Leo đẹp trai</a> </em> </span> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1758 words" > <em>9 min</em> read</span></div></div></header><div class="content"><p>Trong việc module hóa cũng như tạo cấu trúc REST API bạn có thể tự tạo cho mình một framework riêng hoặc sử dụng một framework đã có và đang được phát triển và ưa dùng là <a href="https://www.ruby-grape.org/">grape</a>. tham khảo tại <a href="https://github.com/ruby-grape/grape">đây</a></p><h1 id="grape-api-là-gì-">Grape api là gì ?</h1><p><code class="language-plaintext highlighter-rouge">Grape is a REST-like API framework for Ruby. It's designed to run on Rack or complement existing web application frameworks such as Rails and Sinatra by providing a simple DSL to easily develop RESTful APIs. It has built-in support for common conventions, including multiple formats, subdomain/prefix restriction, content negotiation, versioning and much more.</code></p><ul><li>api frame work<li>Restful Apis<li>Rack, Sinatra support<li>built-in support</ul><p>Nói gọn lại là Grape là một framework tích hợp và ăn nhập với các server như rack, sinsatra để tạo ra hệ thống Restful APIs. Ưu điểm là nó rất nhanh hơn các <code class="language-plaintext highlighter-rouge">rails-api</code> thông thường. Trong bài này tôi sẽ giới thiệu và demo một ứng dụng sử dụng grape api. Với mong muốn đi sâu hơn vào grape và ứng dụng của grape với rails nên tôi sẽ có thể viết nối tiếp một số bài nữa.</p><h1 id="cài-đặt">Cài đặt</h1><p>Trong gemfile</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>gem 'grape'
</pre></table></code></div></div><p>Run bundle : <code class="language-plaintext highlighter-rouge">bundle update</code></p><h2 id="controller-example"><span class="me-2">Controller example</span><a href="#controller-example" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
</pre><td class="rouge-code"><pre><span class="k">module</span> <span class="nn">Twitter</span>
  <span class="k">class</span> <span class="nc">API</span> <span class="o">&lt;</span> <span class="no">Grape</span><span class="o">::</span><span class="no">API</span>
    <span class="n">version</span> <span class="s1">'v1'</span><span class="p">,</span> <span class="ss">using: :header</span><span class="p">,</span> <span class="ss">vendor: </span><span class="s1">'twitter'</span>
    <span class="nb">format</span> <span class="ss">:json</span>
    <span class="n">prefix</span> <span class="ss">:api</span>

    <span class="n">helpers</span> <span class="k">do</span>
      <span class="k">def</span> <span class="nf">current_user</span>
        <span class="vi">@current_user</span> <span class="o">||=</span> <span class="no">User</span><span class="p">.</span><span class="nf">authorize!</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
      <span class="k">end</span>

      <span class="k">def</span> <span class="nf">authenticate!</span>
        <span class="n">error!</span><span class="p">(</span><span class="s1">'401 Unauthorized'</span><span class="p">,</span> <span class="mi">401</span><span class="p">)</span> <span class="k">unless</span> <span class="n">current_user</span>
      <span class="k">end</span>
    <span class="k">end</span>

    <span class="n">resource</span> <span class="ss">:statuses</span> <span class="k">do</span>
      <span class="n">desc</span> <span class="s1">'Return a public timeline.'</span>
      <span class="n">get</span> <span class="ss">:public_timeline</span> <span class="k">do</span>
        <span class="no">Status</span><span class="p">.</span><span class="nf">limit</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
      <span class="k">end</span>

      <span class="n">desc</span> <span class="s1">'Return a personal timeline.'</span>
      <span class="n">get</span> <span class="ss">:home_timeline</span> <span class="k">do</span>
        <span class="n">authenticate!</span>
        <span class="n">current_user</span><span class="p">.</span><span class="nf">statuses</span><span class="p">.</span><span class="nf">limit</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
      <span class="k">end</span>

      <span class="n">desc</span> <span class="s1">'Return a status.'</span>
      <span class="n">params</span> <span class="k">do</span>
        <span class="n">requires</span> <span class="ss">:id</span><span class="p">,</span> <span class="ss">type: </span><span class="no">Integer</span><span class="p">,</span> <span class="ss">desc: </span><span class="s1">'Status ID.'</span>
      <span class="k">end</span>
      <span class="n">route_param</span> <span class="ss">:id</span> <span class="k">do</span>
        <span class="n">get</span> <span class="k">do</span>
          <span class="no">Status</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="ss">:id</span><span class="p">])</span>
        <span class="k">end</span>
      <span class="k">end</span>

      <span class="n">desc</span> <span class="s1">'Create a status.'</span>
      <span class="n">params</span> <span class="k">do</span>
        <span class="n">requires</span> <span class="ss">:status</span><span class="p">,</span> <span class="ss">type: </span><span class="no">String</span><span class="p">,</span> <span class="ss">desc: </span><span class="s1">'Your status.'</span>
      <span class="k">end</span>
      <span class="n">post</span> <span class="k">do</span>
        <span class="n">authenticate!</span>
        <span class="no">Status</span><span class="p">.</span><span class="nf">create!</span><span class="p">({</span>
          <span class="ss">user: </span><span class="n">current_user</span><span class="p">,</span>
          <span class="ss">text: </span><span class="n">params</span><span class="p">[</span><span class="ss">:status</span><span class="p">]</span>
        <span class="p">})</span>
      <span class="k">end</span>

      <span class="n">desc</span> <span class="s1">'Update a status.'</span>
      <span class="n">params</span> <span class="k">do</span>
        <span class="n">requires</span> <span class="ss">:id</span><span class="p">,</span> <span class="ss">type: </span><span class="no">String</span><span class="p">,</span> <span class="ss">desc: </span><span class="s1">'Status ID.'</span>
        <span class="n">requires</span> <span class="ss">:status</span><span class="p">,</span> <span class="ss">type: </span><span class="no">String</span><span class="p">,</span> <span class="ss">desc: </span><span class="s1">'Your status.'</span>
      <span class="k">end</span>
      <span class="n">put</span> <span class="s1">':id'</span> <span class="k">do</span>
        <span class="n">authenticate!</span>
        <span class="n">current_user</span><span class="p">.</span><span class="nf">statuses</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="ss">:id</span><span class="p">]).</span><span class="nf">update</span><span class="p">({</span>
          <span class="ss">user: </span><span class="n">current_user</span><span class="p">,</span>
          <span class="ss">text: </span><span class="n">params</span><span class="p">[</span><span class="ss">:status</span><span class="p">]</span>
        <span class="p">})</span>
      <span class="k">end</span>

      <span class="n">desc</span> <span class="s1">'Delete a status.'</span>
      <span class="n">params</span> <span class="k">do</span>
        <span class="n">requires</span> <span class="ss">:id</span><span class="p">,</span> <span class="ss">type: </span><span class="no">String</span><span class="p">,</span> <span class="ss">desc: </span><span class="s1">'Status ID.'</span>
      <span class="k">end</span>
      <span class="n">delete</span> <span class="s1">':id'</span> <span class="k">do</span>
        <span class="n">authenticate!</span>
        <span class="n">current_user</span><span class="p">.</span><span class="nf">statuses</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="ss">:id</span><span class="p">]).</span><span class="nf">destroy</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></table></code></div></div><h2 id="cấu-trúc-thư-mục"><span class="me-2">Cấu trúc thư mục</span><a href="#cấu-trúc-thư-mục" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li>sơ cấp<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>app
 |––controllers
    |––api
</pre></table></code></div></div><li>mount một file <code class="language-plaintext highlighter-rouge">base.rb</code><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="k">module</span> <span class="nn">API</span>  
  <span class="k">class</span> <span class="nc">Base</span> <span class="o">&lt;</span> <span class="no">Grape</span><span class="o">::</span><span class="no">API</span>
         <span class="n">mount</span> <span class="no">API</span><span class="o">::</span><span class="no">V1</span><span class="o">::</span><span class="no">Base</span>
  <span class="k">end</span>
<span class="k">end</span>  
</pre></table></code></div></div><p>cấu trúc thư mục</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>app
 |––controllers
    |––api
        |––base.rb
</pre></table></code></div></div></ol><h1 id="khái-niệm-cơ-bản">Khái niệm cơ bản</h1><h2 id="mount"><span class="me-2"><strong>mount</strong></span><a href="#mount" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><strong>mount</strong>: là cơ chế nói cho rails biết là grape đang tạo ra số lượng api tương ứng với file</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="no">Twitter</span><span class="o">::</span><span class="no">API</span><span class="p">.</span><span class="nf">compile!</span>
</pre></table></code></div></div><p>Đối với rails để mount một file và tạo ra routes ta cần làm như sau:</p><ul><li>rails &lt; 5.2 sửa lại file <code class="language-plaintext highlighter-rouge">application.rb</code><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">config</span><span class="p">.</span><span class="nf">paths</span><span class="p">.</span><span class="nf">add</span> <span class="no">File</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="s1">'app'</span><span class="p">,</span> <span class="s1">'api'</span><span class="p">),</span> <span class="ss">glob: </span><span class="no">File</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="s1">'**'</span><span class="p">,</span> <span class="s1">'*.rb'</span><span class="p">)</span>
<span class="n">config</span><span class="p">.</span><span class="nf">autoload_paths</span> <span class="o">+=</span> <span class="no">Dir</span><span class="p">[</span><span class="no">Rails</span><span class="p">.</span><span class="nf">root</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="s1">'app'</span><span class="p">,</span> <span class="s1">'api'</span><span class="p">,</span> <span class="s1">'*'</span><span class="p">)]</span>
</pre></table></code></div></div><li>rails thêm vào file <code class="language-plaintext highlighter-rouge">config/routes.rb</code><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">mount</span> <span class="no">Twitter</span><span class="o">::</span><span class="no">API</span> <span class="o">=&gt;</span> <span class="s1">'/'</span>
</pre></table></code></div></div><li>rails 6.0 sửa file <code class="language-plaintext highlighter-rouge">config/initializers/inflections.rb</code><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="no">ActiveSupport</span><span class="o">::</span><span class="no">Inflector</span><span class="p">.</span><span class="nf">inflections</span><span class="p">(</span><span class="ss">:en</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">inflect</span><span class="o">|</span>
<span class="n">inflect</span><span class="p">.</span><span class="nf">acronym</span> <span class="s1">'API'</span>
<span class="k">end</span>
</pre></table></code></div></div><p>Trong việc mount là một cơ chế kỳ ảo của grape đảm bảo việc nested và mở rộng module hóa cũng quản lý version.</p></ul><h2 id="version"><span class="me-2"><strong>version</strong></span><a href="#version" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Từ <strong>version</strong> 1 bạn có thể phát triển lên version 2, 3. Grape dễ dàng quản lý điều đó dựa trên các câu lệnh cùng thư mục</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>app
 |––controllers
       |––api
           |––base.rb
           |––v1
               |––base.rb
</pre></table></code></div></div><p>Các khái niệm cơ bản: There are four strategies in which clients can reach your API’s endpoints: <code class="language-plaintext highlighter-rouge">:path, :header, :accept_version_header and :param</code>. The default strategy is :path.</p><ol><li>path <code class="language-plaintext highlighter-rouge">version 'v1', using: :path</code><br /> use with curl: <code class="language-plaintext highlighter-rouge">curl http://localhost:9292/v1/statuses/public_timeline</code><li>header<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> version 'v1', using: :header, vendor: 'twitter'
</pre></table></code></div></div><p>use with curl:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> curl -H Accept:application/vnd.twitter-v1+json http://localhost:9292/statuses/public_timeline
</pre></table></code></div></div><li>accept_version_header<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>version 'v1', using: :accept_version_header
</pre></table></code></div></div><p>example: <code class="language-plaintext highlighter-rouge"> curl -H "Accept-Version:v1" http://localhost:9292/statuses/public_timeline </code></p><li>param<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>version 'v1', using: :param, parameter: 'v'
</pre></table></code></div></div><p>ex: <code class="language-plaintext highlighter-rouge"> curl http://localhost:9292/statuses/public_timeline?v=v1 </code></p></ol><h2 id="version-mount-nested"><span class="me-2"><strong>version, mount, nested</strong></span><a href="#version-mount-nested" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Giả sử bạn cần mở rộng module v1 bằng việc khải báo thêm các api. bước 1: Tạo folder v1</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>app
 |––controllers
       |––api
           |––base.rb
           |––v1
</pre></table></code></div></div><p>bước 2: với mỗi version tạo một <code class="language-plaintext highlighter-rouge">base.rb</code> riêng:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>app
 |––controllers
       |––api
           |––base.rb
           |––v1
               |––base.rb
</pre></table></code></div></div><p>bước 3: Trong file base khai báo mount thư mục đồng cấp</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="k">module</span> <span class="nn">API</span>
  <span class="k">module</span> <span class="nn">V1</span>
    <span class="k">class</span> <span class="nc">Base</span> <span class="o">&lt;</span> <span class="no">Grape</span><span class="o">::</span><span class="no">API</span>
      <span class="n">mount</span> <span class="no">V1</span><span class="o">::</span><span class="no">Users</span>
      <span class="c1"># mount API::V1::AnotherResource</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></table></code></div></div><p>bước 4: khai báo api tương ứng <code class="language-plaintext highlighter-rouge">user.rb</code></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>app
 |––controllers
       |––api
           |––base.rb
           |––v1
               |––base.rb
               |––users.rb
</pre></table></code></div></div><h2 id="api-end-point"><span class="me-2"><strong>api end point</strong></span><a href="#api-end-point" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Như ở trên khi bạn khai báo 1 api đồng cấp, đó cũng là api end point. Đối với một api end point:</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="k">module</span> <span class="nn">API</span>  
  <span class="k">module</span> <span class="nn">V1</span>
    <span class="k">class</span> <span class="nc">Users</span> <span class="o">&lt;</span> <span class="no">Grape</span><span class="o">::</span><span class="no">API</span>
      <span class="kp">include</span> <span class="no">API</span><span class="o">::</span><span class="no">V1</span><span class="o">::</span><span class="no">Defaults</span>

      <span class="n">resource</span> <span class="ss">:users</span> <span class="k">do</span>
        <span class="n">desc</span> <span class="s2">"Return all users"</span>
        <span class="n">get</span> <span class="s2">""</span><span class="p">,</span> <span class="ss">root: :users</span> <span class="k">do</span>
          <span class="no">User</span><span class="p">.</span><span class="nf">all</span>
        <span class="k">end</span>

        <span class="n">desc</span> <span class="s2">"Return a user"</span>
        <span class="n">params</span> <span class="k">do</span>
          <span class="n">requires</span> <span class="ss">:id</span><span class="p">,</span> <span class="ss">type: </span><span class="no">String</span><span class="p">,</span> <span class="ss">desc: </span><span class="s2">"ID of the user"</span>
        <span class="k">end</span>
        <span class="n">get</span> <span class="s2">":id"</span><span class="p">,</span> <span class="ss">root: </span><span class="s2">"user"</span> <span class="k">do</span>
          <span class="no">User</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="ss">id: </span><span class="n">params</span><span class="p">[</span><span class="ss">:user_id</span><span class="p">]).</span><span class="nf">first</span>
        <span class="k">end</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>  
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">resource</code>: khai báo router <code class="language-plaintext highlighter-rouge">desc</code>: mô tả <code class="language-plaintext highlighter-rouge">get "", root: :users do</code> khai báo url api lấy toàn bộ user ex: <code class="language-plaintext highlighter-rouge">http://localhost:3000/api/v1/users</code> tool: <strong>POSTMAN</strong></p><h1 id="action-helper">Action, Helper</h1><h2 id="mixin-format-dữ-liệu-các-hàm-dùng-chung"><span class="me-2">Mixin, format dữ liệu, các hàm dùng chung</span><a href="#mixin-format-dữ-liệu-các-hàm-dùng-chung" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>được khai báo tại file <code class="language-plaintext highlighter-rouge">defaults.rb</code>, ex: <code class="language-plaintext highlighter-rouge">app/controllers/api/v1/defaults.rb</code></p><ul><li>khai báo định dạng output như json<li>các hàm như authencation.<div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
</pre><td class="rouge-code"><pre><span class="k">module</span> <span class="nn">API</span>  
<span class="k">module</span> <span class="nn">V1</span>
  <span class="k">module</span> <span class="nn">Defaults</span>
    <span class="kp">extend</span> <span class="no">ActiveSupport</span><span class="o">::</span><span class="no">Concern</span>

    <span class="n">included</span> <span class="k">do</span>
      <span class="n">prefix</span> <span class="s2">"api"</span>
      <span class="n">version</span> <span class="s2">"v1"</span><span class="p">,</span> <span class="ss">using: :path</span>
      <span class="n">default_format</span> <span class="ss">:json</span>
      <span class="nb">format</span> <span class="ss">:json</span>
      <span class="n">formatter</span> <span class="ss">:json</span><span class="p">,</span> 
           <span class="no">Grape</span><span class="o">::</span><span class="no">Formatter</span><span class="o">::</span><span class="no">ActiveModelSerializers</span>

      <span class="n">helpers</span> <span class="k">do</span>
        <span class="k">def</span> <span class="nf">permitted_params</span>
          <span class="vi">@permitted_params</span> <span class="o">||=</span> <span class="n">declared</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> 
             <span class="ss">include_missing: </span><span class="kp">false</span><span class="p">)</span>
        <span class="k">end</span>

        <span class="k">def</span> <span class="nf">logger</span>
          <span class="no">Rails</span><span class="p">.</span><span class="nf">logger</span>
        <span class="k">end</span>
      <span class="k">end</span>
        
      <span class="c1"># check authentice_user</span>
      <span class="k">def</span> <span class="nf">authenticate_user!</span>
          <span class="n">uid</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="nf">headers</span><span class="p">[</span><span class="s2">"Uid"</span><span class="p">]</span>
          <span class="n">token</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="nf">headers</span><span class="p">[</span><span class="s2">"Access-Token"</span><span class="p">]</span>
          <span class="vi">@current_user</span> <span class="o">=</span> <span class="no">User</span><span class="p">.</span><span class="nf">find_by</span><span class="p">(</span><span class="ss">uid: </span><span class="n">uid</span><span class="p">)</span>
          <span class="k">unless</span> <span class="vi">@current_user</span> <span class="o">&amp;&amp;</span> <span class="vi">@current_user</span><span class="p">.</span><span class="nf">valid_token?</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
            <span class="n">api_error!</span><span class="p">(</span><span class="s2">"You need to log in to use the app."</span><span class="p">,</span> <span class="s2">"failure"</span><span class="p">,</span> <span class="mi">401</span><span class="p">,</span> <span class="p">{})</span>
          <span class="k">end</span>
        <span class="k">end</span>
		
      <span class="c1"># Hàm hiển thị errors message khi lỗi</span>
      <span class="k">def</span> <span class="nf">api_error!</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">error_code</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">header</span><span class="p">)</span>
         <span class="n">error!</span><span class="p">({</span><span class="ss">message: </span><span class="n">message</span><span class="p">,</span> <span class="ss">code: </span><span class="n">error_code</span><span class="p">},</span> <span class="n">status</span><span class="p">,</span> <span class="n">header</span><span class="p">)</span>
      <span class="k">end</span>
        
      <span class="c1">#  # Hàm raise errors message khi lỗi</span>
      <span class="k">def</span> <span class="nf">api_error_log</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
          <span class="vi">@logger</span> <span class="o">||=</span> <span class="no">Logger</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="no">ProjectLogger</span><span class="p">.</span><span class="nf">log_path</span><span class="p">(</span><span class="s2">"project_api"</span><span class="p">))</span>
          <span class="vi">@logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="s2">"=============</span><span class="si">#{</span><span class="no">Time</span><span class="p">.</span><span class="nf">zone</span><span class="p">.</span><span class="nf">now</span><span class="p">.</span><span class="nf">to_s</span><span class="si">}</span><span class="s2">==================</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
          <span class="vi">@logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="s2">"</span><span class="si">#{</span><span class="n">message</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
       <span class="k">end</span>
          
      <span class="n">rescue_from</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">RecordNotFound</span> <span class="k">do</span> <span class="o">|</span><span class="n">e</span><span class="o">|</span>
        <span class="n">error_response</span><span class="p">(</span><span class="ss">message: </span><span class="n">e</span><span class="p">.</span><span class="nf">message</span><span class="p">,</span> <span class="ss">status: </span><span class="mi">404</span><span class="p">)</span>
      <span class="k">end</span>

      <span class="n">rescue_from</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">RecordInvalid</span> <span class="k">do</span> <span class="o">|</span><span class="n">e</span><span class="o">|</span>
        <span class="n">error_response</span><span class="p">(</span><span class="ss">message: </span><span class="n">e</span><span class="p">.</span><span class="nf">message</span><span class="p">,</span> <span class="ss">status: </span><span class="mi">422</span><span class="p">)</span>
      <span class="k">end</span>
        
      <span class="n">rescue_from</span> <span class="no">Grape</span><span class="o">::</span><span class="no">Exceptions</span><span class="o">::</span><span class="no">ValidationErrors</span> <span class="k">do</span> <span class="o">|</span><span class="n">e</span><span class="o">|</span>
        <span class="n">error_response</span><span class="p">(</span><span class="ss">message: </span><span class="n">e</span><span class="p">.</span><span class="nf">message</span><span class="p">,</span> <span class="ss">status: </span><span class="mi">400</span><span class="p">)</span>
      <span class="k">end</span>
        
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
<span class="k">end</span>
</pre></table></code></div></div></ul><h2 id="action-callback"><span class="me-2">Action callback</span><a href="#action-callback" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Grape vấn support đầy đủ các hàm call back như:<br /> 1. before<br /> 2. before_validation<br /> 3. validations<br /> 4. after_validation<br /> 5. the API call<br /> 6. after 7. finally</p><p>Example:</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">MyAPI</span> <span class="o">&lt;</span> <span class="no">Grape</span><span class="o">::</span><span class="no">API</span>
  <span class="n">get</span> <span class="s1">'/'</span> <span class="k">do</span>
    <span class="s2">"root - </span><span class="si">#{</span><span class="vi">@blah</span><span class="si">}</span><span class="s2">"</span>
  <span class="k">end</span>

  <span class="n">namespace</span> <span class="ss">:foo</span> <span class="k">do</span>
    <span class="n">before</span> <span class="k">do</span>
      <span class="vi">@blah</span> <span class="o">=</span> <span class="s1">'blah'</span>
    <span class="k">end</span>

    <span class="n">get</span> <span class="s1">'/'</span> <span class="k">do</span>
      <span class="s2">"root - foo - </span><span class="si">#{</span><span class="vi">@blah</span><span class="si">}</span><span class="s2">"</span>
    <span class="k">end</span>

    <span class="n">namespace</span> <span class="ss">:bar</span> <span class="k">do</span>
      <span class="n">get</span> <span class="s1">'/'</span> <span class="k">do</span>
        <span class="s2">"root - foo - bar - </span><span class="si">#{</span><span class="vi">@blah</span><span class="si">}</span><span class="s2">"</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></table></code></div></div><p>kết quả</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>GET /           # 'root - '
GET /foo        # 'root - foo - blah'
GET /foo/bar    # 'root - foo - bar - blah'
</pre></table></code></div></div><p>example version</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">Test</span> <span class="o">&lt;</span> <span class="no">Grape</span><span class="o">::</span><span class="no">API</span>
  <span class="n">resource</span> <span class="ss">:foo</span> <span class="k">do</span>
    <span class="n">version</span> <span class="s1">'v1'</span><span class="p">,</span> <span class="ss">:using</span> <span class="o">=&gt;</span> <span class="ss">:path</span> <span class="k">do</span>
      <span class="n">before</span> <span class="k">do</span>
        <span class="vi">@output</span> <span class="o">||=</span> <span class="s1">'v1-'</span>
      <span class="k">end</span>
      <span class="n">get</span> <span class="s1">'/'</span> <span class="k">do</span>
        <span class="vi">@output</span> <span class="o">+=</span> <span class="s1">'hello'</span>
      <span class="k">end</span>
    <span class="k">end</span>

    <span class="n">version</span> <span class="s1">'v2'</span><span class="p">,</span> <span class="ss">:using</span> <span class="o">=&gt;</span> <span class="ss">:path</span> <span class="k">do</span>
      <span class="n">before</span> <span class="k">do</span>
        <span class="vi">@output</span> <span class="o">||=</span> <span class="s1">'v2-'</span>
      <span class="k">end</span>
      <span class="n">get</span> <span class="s1">'/'</span> <span class="k">do</span>
        <span class="vi">@output</span> <span class="o">+=</span> <span class="s1">'hello'</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></table></code></div></div><p>kết quả</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>GET /foo/v1       # 'v1-hello'
GET /foo/v2       # 'v2-hello'
</pre></table></code></div></div><h2 id="rspec"><span class="me-2">Rspec</span><a href="#rspec" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Viết rồi kiểm thử làm sao ? -&gt; viết rspec cho api ta có thể dùng gem <a href="https://github.com/brooklynDev/airborne">airborne</a>. install:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>gem install airborne
</pre></table></code></div></div><p>cấu trúc thư mục</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>spec
 |––api
       |––v1
           |––users_spec
</pre></table></code></div></div><p>nội dung file test:</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="nb">require</span> <span class="s2">"rails_helper"</span>
<span class="nb">require</span> <span class="s2">"airborne"</span>

<span class="n">describe</span> <span class="s2">"API::V1::Users"</span> <span class="k">do</span>
  <span class="n">after</span><span class="p">(</span><span class="ss">:all</span><span class="p">){</span><span class="no">I18n</span><span class="p">.</span><span class="nf">locale</span> <span class="o">=</span> <span class="ss">:ja</span><span class="p">}</span>
  <span class="n">describe</span> <span class="s2">"POST api/v1/users"</span> <span class="k">do</span>
    <span class="n">let!</span><span class="p">(</span><span class="ss">:user</span><span class="p">)</span> <span class="k">do</span>
      <span class="no">FactoryGirl</span><span class="p">.</span><span class="nf">create</span> <span class="ss">:user</span><span class="p">,</span> <span class="ss">id: </span><span class="mi">1</span><span class="p">,</span> <span class="ss">email: </span><span class="s2">"test@gmail.com"</span><span class="p">,</span> <span class="ss">first_name: </span><span class="s2">"James"</span><span class="p">,</span>
        <span class="ss">last_name: </span><span class="s2">"Bond"</span><span class="p">,</span> <span class="ss">provider: </span><span class="s2">"email"</span>
    <span class="k">end</span>

    <span class="n">context</span> <span class="s2">"when user update successfully"</span> <span class="k">do</span>
      <span class="n">let</span><span class="p">(</span><span class="ss">:api_response</span><span class="p">){</span><span class="no">FactoryGirl</span><span class="p">.</span><span class="nf">build</span><span class="p">(</span><span class="ss">:api_update_user_success_response</span><span class="p">).</span><span class="nf">deep_symbolize_keys</span><span class="p">}</span>

      <span class="n">before</span> <span class="k">do</span>
        <span class="n">post</span><span class="p">(</span><span class="s2">"/api/v1/users"</span><span class="p">,</span> <span class="p">{</span><span class="ss">first_name: </span><span class="s2">"hitorri"</span><span class="p">},</span>
          <span class="p">{</span><span class="s2">"Accept-Language"</span><span class="p">:</span> <span class="s2">"en"</span><span class="p">,</span> <span class="s2">"App-Version"</span><span class="p">:</span> <span class="s2">"knt/1.0"</span><span class="p">,</span> <span class="s2">"Uid"</span><span class="p">:</span> <span class="n">user</span><span class="p">.</span><span class="nf">uid</span><span class="p">,</span> <span class="s2">"Access-Token"</span><span class="p">:</span> <span class="n">user</span><span class="p">.</span><span class="nf">access_token</span><span class="p">})</span>
      <span class="k">end</span>

      <span class="n">it</span><span class="p">{</span><span class="n">expect_json</span><span class="p">(</span><span class="n">api_response</span><span class="p">)}</span>
    <span class="k">end</span>
  <span class="k">end</span>
 <span class="k">end</span>

</pre></table></code></div></div><h2 id="cors"><span class="me-2">CORS</span><a href="#cors" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>using gem <code class="language-plaintext highlighter-rouge">rack-cors</code>, cấu hình tại file <code class="language-plaintext highlighter-rouge">config.ru</code></p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="nb">require</span> <span class="s1">'rack/cors'</span>

<span class="n">use</span> <span class="no">Rack</span><span class="o">::</span><span class="no">Cors</span> <span class="k">do</span>
  <span class="n">allow</span> <span class="k">do</span>
    <span class="n">origins</span> <span class="s1">'*'</span>
    <span class="n">resource</span> <span class="s1">'*'</span><span class="p">,</span> <span class="ss">headers: :any</span><span class="p">,</span> <span class="ss">methods: :get</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="n">run</span> <span class="no">Twitter</span><span class="o">::</span><span class="no">API</span>
</pre></table></code></div></div><h2 id="serializing"><span class="me-2">Serializing</span><a href="#serializing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Công việc của chúng ta là convert mảng sang JSON. Để làm được việc này chúng ta cài thêm gem <code class="language-plaintext highlighter-rouge">grape-active_model_serializers</code></p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="k">module</span> <span class="nn">API</span>
  <span class="k">module</span> <span class="nn">V1</span>
    <span class="k">module</span> <span class="nn">Defaults</span>
      <span class="kp">extend</span> <span class="no">ActiveSupport</span><span class="o">::</span><span class="no">Concern</span>

      <span class="n">included</span> <span class="k">do</span>
        <span class="n">prefix</span> <span class="s2">"api"</span>
        <span class="n">version</span> <span class="s2">"v1"</span><span class="p">,</span> <span class="ss">using: :path</span>
        <span class="n">default_format</span> <span class="ss">:json</span>
        <span class="nb">format</span> <span class="ss">:json</span>
        <span class="n">formatter</span> <span class="ss">:json</span><span class="p">,</span> 
             <span class="no">Grape</span><span class="o">::</span><span class="no">Formatter</span><span class="o">::</span><span class="no">ActiveModelSerializers</span>
         <span class="o">...</span>
</pre></table></code></div></div><h3 id="viết-file-serializers"><span class="me-2">Viết file serializers</span><a href="#viết-file-serializers" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Create a directory, <code class="language-plaintext highlighter-rouge">serializers</code>, in the top level of your app. Create a <code class="language-plaintext highlighter-rouge">graduate_serializer.rb</code> file in that directory. Here is where our serializer will live. <code class="language-plaintext highlighter-rouge">app/serializers/graduate_serializer.rb</code></p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">GraduateSerializer</span> <span class="o">&lt;</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Serializer</span>

  <span class="n">attributes</span> <span class="ss">:id</span><span class="p">,</span> <span class="ss">:first_name</span><span class="p">,</span> <span class="ss">:last_name</span><span class="p">,</span> <span class="ss">:cohort</span><span class="p">,</span> 
       <span class="ss">:current_job</span><span class="p">,</span> <span class="ss">:bio</span><span class="p">,</span> <span class="ss">:news</span><span class="p">,</span> <span class="ss">:website</span><span class="p">,</span> <span class="ss">:picture</span><span class="p">,</span> 
       <span class="ss">:created_at</span><span class="p">,</span> <span class="ss">:updated_at</span>
<span class="k">end</span>
</pre></table></code></div></div><h1 id="grape-gem-addition">Grape Gem addition</h1><h2 id="grape-swagger"><span class="me-2">Grape Swagger</span><a href="#grape-swagger" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li>Add gem ‘grape-swagger’ to your Gemfile and <code class="language-plaintext highlighter-rouge">bundle install</code>.<li>Add grape-swagger documentation to the root or base class of your API. tại file <code class="language-plaintext highlighter-rouge">app/controllers/api/v1/base.rb</code> thêm đoạn sau:<div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="nb">require</span> <span class="s2">"grape-swagger"</span>
         <span class="o">...</span>
   <span class="n">add_swagger_documentation</span><span class="p">(</span>
     <span class="ss">api_version: </span><span class="s2">"v1"</span><span class="p">,</span>
     <span class="ss">hide_documentation_path: </span><span class="kp">true</span><span class="p">,</span>
     <span class="ss">mount_path: </span><span class="s2">"/api/v1/swagger_doc"</span><span class="p">,</span>
     <span class="ss">hide_format: </span><span class="kp">true</span>
   <span class="p">)</span>
 <span class="k">end</span>
</pre></table></code></div></div><li>Add the documentation endpoint to your routes. tại file <code class="language-plaintext highlighter-rouge">config/routes.rb</code>:<div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">mount</span> <span class="no">GrapeSwaggerRails</span><span class="o">::</span><span class="no">Engine</span><span class="p">,</span> <span class="ss">at: </span><span class="s2">"/documentation"</span>
</pre></table></code></div></div><p>vào url: <code class="language-plaintext highlighter-rouge">http://localhost/documentation</code> bạn sẽ redirect tới: <code class="language-plaintext highlighter-rouge">http://localhost:3000/api/v1/swagger_doc</code></p></ol><h2 id="grape-entity"><span class="me-2">Grape Entity</span><a href="#grape-entity" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Có thể tham khảo thêm tại đây</p><h2 id="grape-logger"><span class="me-2">Grape Logger</span><a href="#grape-logger" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Có thể tham khảo tại đây</p><h2 id="grape-swagger-representable"><span class="me-2">Grape Swagger representable</span><a href="#grape-swagger-representable" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Có thể tham khảo thêm tại đây</p><h1 id="tài-liệu-tham-khảo">Tài liệu tham khảo</h1><ol><li>https://viblo.asia/p/xay-dung-api-voi-grape-bWrZne1vKxw<li>https://www.thegreatcodeadventure.com/making-a-rails-api-with-grap/<li>https://github.com/ruby-grape/grape#what-is-grape</ol></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/framework/">Framework</a>, <a href="/categories/rails/">Rails</a>, <a href="/categories/api/">api</a>, <a href="/categories/grape/">grape</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/rails/" class="post-tag no-text-decoration" >rails</a> <a href="/tags/api/" class="post-tag no-text-decoration" >api</a> <a href="/tags/grape/" class="post-tag no-text-decoration" >grape</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/AdHuybinh" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/alz.ailove" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=T%E1%BA%A1o%20Rails%20API%20v%E1%BB%9Bi%20Grape%20-%20Programmer%20From%20Zero%20To%20Mountaint&url=https%3A%2F%2Fzmerrychristmas.github.io%2Fposts%2FTao-rails-api-voi-grape%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/in/b%C3%ACnh-nguy%E1%BB%85n-75312a7b/" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/solid-principles-and-solid-in-frameworks/">SOLID principles, and SOLID in frameworks (part 1)</a><li class="text-truncate lh-lg"> <a href="/posts/nodejs-concept/">Node.JS concept</a><li class="text-truncate lh-lg"> <a href="/posts/text-and-typography/">Text and Typography</a><li class="text-truncate lh-lg"> <a href="/posts/getting-started/">Getting Started</a><li class="text-truncate lh-lg"> <a href="/posts/enable-google-pv/">Enable Google Page Views</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/rails/">rails</a> <a class="post-tag btn btn-outline-primary" href="/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/tags/javascript/">javascript</a> <a class="post-tag btn btn-outline-primary" href="/tags/ruby/">ruby</a> <a class="post-tag btn btn-outline-primary" href="/tags/api/">api</a> <a class="post-tag btn btn-outline-primary" href="/tags/aurora/">aurora</a> <a class="post-tag btn btn-outline-primary" href="/tags/jekyll/">jekyll</a> <a class="post-tag btn btn-outline-primary" href="/tags/laravel/">laravel</a> <a class="post-tag btn btn-outline-primary" href="/tags/php/">php</a> <a class="post-tag btn btn-outline-primary" href="/tags/python/">python</a></div></section></div><section id="toc-wrapper" class="ps-0 pe-4"><h2 class="panel-heading ps-3 pt-2 mb-2">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/shortened-url-by-ruby-on-rails/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1650042000" data-df="ll" > Apr 16, 2022 </time><h4 class="pt-0 my-2">How to build a Shortened URL By Ruby On Rails like Bitly or Twitter</h4><div class="text-muted"><p> How to build a Shortened URL By Ruby On Rails like Bitly or Twitter Give a website shortenedUrl to convert longURL to short URL with alpha lexigraphy encoded/decoded response to User. Give two e...</p></div></div></a></article><article class="col"> <a href="/posts/bug-rails-gem-server-sysopen/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1616346000" data-df="ll" > Mar 22, 2021 </time><h4 class="pt-0 my-2">Bug thần thánh permission denied @ rb_sysopen</h4><div class="text-muted"><p> Bug rack/server.rb:362:in initialize: Permission denied @ rb_sysopen (Errno::EACCES) phiên bản sử dụng là rvm Try first update gem owner 1 sudo chown -R userowner:yourgroup ~/.rvm Update permissi...</p></div></div></a></article><article class="col"> <a href="/posts/cai-dat-moi-truong-ruby-on-rails-tren-ubuntu/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1616346000" data-df="ll" > Mar 22, 2021 </time><h4 class="pt-0 my-2">Cài đặt môi trường Ruby on Rails trên ubuntu 20.04</h4><div class="text-muted"><p> Cài đặt môi trường Ruby on Rails trên ubuntu Cài đặt truyền thống Ruby Để cài đặt môi trường code ruby trên ubuntu rất đơn giản vì mặc định ubuntu đã cài đặt sẵn ruby theo từng phiên bản của ubuntu...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/tao-blog-don-gian-voi-jekyll/" class="btn btn-outline-primary" aria-label="Older" ><p>Tạo Blog đơn giản với Github và Jekyll</p></a> <a href="/posts/bug-rails-gem-server-sysopen/" class="btn btn-outline-primary" aria-label="Newer" ><p>Bug thần thánh permission denied @ rb_sysopen</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2024</time> <a href="https://twitter.com/username">Leo đẹp trai</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/rails/">rails</a> <a class="post-tag btn btn-outline-primary" href="/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/tags/javascript/">javascript</a> <a class="post-tag btn btn-outline-primary" href="/tags/ruby/">ruby</a> <a class="post-tag btn btn-outline-primary" href="/tags/api/">api</a> <a class="post-tag btn btn-outline-primary" href="/tags/aurora/">aurora</a> <a class="post-tag btn btn-outline-primary" href="/tags/jekyll/">jekyll</a> <a class="post-tag btn btn-outline-primary" href="/tags/laravel/">laravel</a> <a class="post-tag btn btn-outline-primary" href="/tags/php/">php</a> <a class="post-tag btn btn-outline-primary" href="/tags/python/">python</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/en.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js,npm/tocbot@4.25.0/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/assets/js/dist/app.min.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-S57T0PJRJG"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-S57T0PJRJG'); }); </script> <script> /* Note: dependent library will be loaded in `js-selector.html` */ SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
