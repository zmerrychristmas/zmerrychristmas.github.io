<!doctype html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="AWS Api gateway, Lambda, Serverless, and Services part I" /><meta name="author" content="Leo đẹp trai" /><meta property="og:locale" content="en_US" /><meta name="description" content="AWS API Gateway AWS Lambda + API Gateway: No infrastructure to manage Support for the WebSocket Protocol Handle API versioning (v1, v2…) Handle different environments (dev, test, prod…) Handle security (Authentication and Authorization) Create API keys, handle request throttling Swagger / Open API import to quickly define APIs Transform and validate requests and responses Generate SDK and API specifications Cache API responses" /><meta property="og:description" content="AWS API Gateway AWS Lambda + API Gateway: No infrastructure to manage Support for the WebSocket Protocol Handle API versioning (v1, v2…) Handle different environments (dev, test, prod…) Handle security (Authentication and Authorization) Create API keys, handle request throttling Swagger / Open API import to quickly define APIs Transform and validate requests and responses Generate SDK and API specifications Cache API responses" /><link rel="canonical" href="https://zmerrychristmas.github.io/posts/aws-api-gateway-lambda-serverless-and-services/" /><meta property="og:url" content="https://zmerrychristmas.github.io/posts/aws-api-gateway-lambda-serverless-and-services/" /><meta property="og:site_name" content="Programmer From Zero To Mountaint" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-12-05T00:00:00+07:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="AWS Api gateway, Lambda, Serverless, and Services part I" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@Leo đẹp trai" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Leo đẹp trai"},"dateModified":"2022-12-10T16:28:10+07:00","datePublished":"2022-12-05T00:00:00+07:00","description":"AWS API Gateway AWS Lambda + API Gateway: No infrastructure to manage Support for the WebSocket Protocol Handle API versioning (v1, v2…) Handle different environments (dev, test, prod…) Handle security (Authentication and Authorization) Create API keys, handle request throttling Swagger / Open API import to quickly define APIs Transform and validate requests and responses Generate SDK and API specifications Cache API responses","headline":"AWS Api gateway, Lambda, Serverless, and Services part I","mainEntityOfPage":{"@type":"WebPage","@id":"https://zmerrychristmas.github.io/posts/aws-api-gateway-lambda-serverless-and-services/"},"url":"https://zmerrychristmas.github.io/posts/aws-api-gateway-lambda-serverless-and-services/"}</script><meta name="pwa-cache" content="true"><title>AWS Api gateway, Lambda, Serverless, and Services part I | Programmer From Zero To Mountaint</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Programmer From Zero To Mountaint"><meta name="application-name" content="Programmer From Zero To Mountaint"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="preconnect" href="https://polyfill.io" ><link rel="dns-prefetch" href="https://polyfill.io" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.25.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return 'mode'; } static get MODE_ATTR() { return 'data-mode'; } static get DARK_MODE() { return 'dark'; } static get LIGHT_MODE() { return 'light'; } static get ID() { return 'mode-toggle'; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia('(prefers-color-scheme: dark)'); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { document.documentElement.removeAttribute(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage( { direction: ModeToggle.ID, message: this.modeStatus }, '*' ); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.notify(); } /* flipMode() */ } /* ModeToggle */ const modeToggle = new ModeToggle(); </script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/portfolio/assets/img/portfolio/leo/horse-racing.webp" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a><h1 class="site-title"> <a href="/">Programmer From Zero To Mountaint</a></h1><p class="site-subtitle fst-italic mb-0">Programmer blog</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/portfoio/" class="nav-link"> <i class="fa-fw fas fa-paper-plane"></i> <span>PORTFOLIO</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/zmerrychristmas" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fa-brands fa-x-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['huybinh.ad','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a> <a href="https://www.linkedin.com/in/b%C3%ACnh-nguy%E1%BB%85n-75312a7b/" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>AWS Api gateway, Lambda, Serverless, and Services part I</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1"><header><h1 data-toc-skip>AWS Api gateway, Lambda, Serverless, and Services part I</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1670173200" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Dec 5, 2022 </time> </span> <span> Updated <time data-ts="1670664490" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Dec 10, 2022 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/username">Leo đẹp trai</a> </em> </span> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="3423 words" > <em>19 min</em> read</span></div></div></header><div class="content"><h1 id="aws-api-gateway">AWS API Gateway</h1><ul><li>AWS Lambda + API Gateway: No infrastructure to manage<li>Support for the WebSocket Protocol<li>Handle API versioning (v1, v2…)<li>Handle different environments (dev, test, prod…)<li>Handle security (Authentication and Authorization)<li>Create API keys, handle request throttling<li>Swagger / Open API import to quickly define APIs<li>Transform and validate requests and responses<li>Generate SDK and API specifications<li>Cache API responses</ul><h2 id="api-gateway--integrations-high-level"><span class="me-2">API Gateway – Integrations High Level</span><a href="#api-gateway--integrations-high-level" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Lambda Function<ul><li>Invoke Lambda function<li>Easy way to expose REST API backed by AWS Lambda</ul><li>HTTP<ul><li>Expose HTTP endpoint in the backend<li>Example: internal HTTP API on premise, Application Load Balancer…<li>Why? Add rate limiting, caching, user authentications, API keys, etc…</ul><li>AWS Service<ul><li>Expose any AWS API through the API Gateway?<li>Example: start an AWS Step Function workflow, post a message to SQS<li>Why? Add authentication, deploy publicly, rate control…</ul></ul><h2 id="api-gateway---endpoint-types"><span class="me-2">API Gateway - Endpoint Types</span><a href="#api-gateway---endpoint-types" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Edge-Optimized (default): For global clients<ul><li>Requests are routed through the CloudFront Edge locations (improves latency)<li>The API Gateway still lives in nly one region</ul><li>Regional:<ul><li>For client within the same region<li>Cloud manually combine with CloudFront (more control over the caching strategies and the distribution)</ul><li>Private:<ul><li>Can only be accessed from your VPC using an interface VPC endpint (ENI)<li>Use a resource policy to define access</ul></ul><h2 id="api-gateway--security-iam-permissions"><span class="me-2">API Gateway – Security: IAM Permissions</span><a href="#api-gateway--security-iam-permissions" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Create an IAM policy <strong>authorization</strong> and attach to User / Role<li>API Gateway verifies IAM permissions passed by the calling application<li>Good to provide access within your own infrastructure<li>Leverages “Sig v4” capability where IAM credential are in headers</ul><h2 id="api-gateway--security-lambda-authorizer-formerly-custom-authorizers"><span class="me-2">API Gateway – Security: Lambda Authorizer (formerly Custom Authorizers)</span><a href="#api-gateway--security-lambda-authorizer-formerly-custom-authorizers" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Uses AWS Lambda to <strong>validate</strong> the token in header being passed<li>Option to <strong>cache</strong> result of authentication<li>Help to use Oauth / SAML / 3rd party type of authentication<li>Lambda must return an IAM policy for the user <a href="https://ibb.co/rsGNsWJ" class="popup img-link shimmer"><img src="https://ibb.co/rsGNsWJ" alt="Sample" title="title" loading="lazy"></a></ul><h2 id="api-gateway--security-cognito-user-pools"><span class="me-2">API Gateway – Security: Cognito User Pools</span><a href="#api-gateway--security-cognito-user-pools" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Cognito fully manages user <strong>lifecycle</strong><li>API gateway verifies identity <strong>automatically</strong> from AWS Cognito<li>No custom implementation required<li>Cognito only helps with authentication, not authorization <a href="https://ibb.co/Y7ZSyRF" class="popup img-link shimmer"><img src="https://ibb.co/Y7ZSyRF" alt="" title="cognito user pools" loading="lazy"></a></ul><h2 id="api-gateway--security--summary"><span class="me-2">API Gateway – Security – Summary</span><a href="#api-gateway--security--summary" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li>IAM<ul><li>Greate for users/ roles already within your AWS account<li>Handle authentication + authorization<li>Leverages Sig v4</ul><li>Custom Authorizer:<ul><li>Greate for 3rd party tokens<li>Very flexible in terms of what IAM policy is returned<li>Handle Authentication + Authorization<li>Pay per Lambda invocation</ul><li>Cognito User Pool<ul><li>you manage your user pool (can be backed by Facebookm Google login etc…)<li>No need to write any custom code<li>Must implement authorization in the backend</ul></ol><h1 id="aws-integration--messaginng">AWS Integration &amp; Messaginng</h1><p>SQS, SNS &amp; Kinesis</p><ul><li>When we start deploying multiple applications, they will inevitably need to communicate with one another<li>There are two patterns of application communication<ul><li>Synchromous communication (app to app)<li>Asynchronous / Evenbased (app to queue to app)</ul></ul><h2 id="introdution"><span class="me-2">Introdution</span><a href="#introdution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Synchronnous between applications can be problematic if there are sudden spikes of traffic<li>What if you need to suddenly encode 1000 videos but usually it’s 10?<li>in that case, it better to decouple your applications,<ul><li>SQS: queue model<li>SNS: pub/sub model<li>Kinesis: real-time streaming model</ul><li>These services can scale independently from our application!</ul><h2 id="amazon-sqs-whats-a-queue"><span class="me-2">Amazon SQS, What’s a queue?</span><a href="#amazon-sqs-whats-a-queue" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="https://data.terabox.com/thumbnail/e19ff69d211fc1e51950db00c82dca33?fid=4401547290288-250528-572541249214972&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-LxKWvtxa2erWuhJObtVehWte5ts%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=100591921571805435&amp;dp-callid=0&amp;time=1667109600&amp;size=c1680_u1050&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" class="popup img-link shimmer"><img src="https://data.terabox.com/thumbnail/e19ff69d211fc1e51950db00c82dca33?fid=4401547290288-250528-572541249214972&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-LxKWvtxa2erWuhJObtVehWte5ts%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=100591921571805435&amp;dp-callid=0&amp;time=1667109600&amp;size=c1680_u1050&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" alt="" loading="lazy"></a></p><h2 id="sqs---standard-queue"><span class="me-2">SQS - Standard queue</span><a href="#sqs---standard-queue" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Oldest offering (over 10 years old)<li>Fully managed service, used to decouple applications<li>Attributes:<ul><li>unlimited throughput, unlimited number of messages in queue<li>Default retention of message: 4 days, maxximum of 14 days<li>Low latenccy (&lt; 10ms on publish and receive)<li>Limitation of 256kb per message sent</ul><li>Can have duplicate messages (at least once delivery, occasionally)<li>Can have out of order messages (best effort ordering)</ul><h2 id="sqs---product-messages"><span class="me-2">SQS - product messages</span><a href="#sqs---product-messages" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Produced to SQS using the SDK (SendMessage API)<li>The message is persited in SQS until consumer deletes it<li>Message retention: default 4 days, upto 14days<li>Example:<ul><li>order id<li>customer id<li>any attributes you want</ul><li>SQS standard: unlimited throughput</ul><h2 id="sqs---consuming-messages"><span class="me-2">SQS - Consuming messages</span><a href="#sqs---consuming-messages" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Consumes (running on EC2 instances, Servers, or AWS lambda)…<li>Poll SQS for messages (receive up to 10 messages at a time)<li>Process the messages (example: insert the message inyo an RDS database)<li>Delete the messages using thhe deleteMessage API</ul><h2 id="sqs---mutiple-ec2-innstances-consumers"><span class="me-2">SQS - Mutiple EC2 Innstances Consumers</span><a href="#sqs---mutiple-ec2-innstances-consumers" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Consumers receive and process messages in parallel<li>At least once delivery<li>Best effort message ordering<li>Consumers delete messages after processig them<li>We can scale consumers horzontally to improve throughput of processing</ul><h2 id="sqs-with-auto-scaling-group-asg"><span class="me-2">SQS with auto scaling group (ASG)</span><a href="#sqs-with-auto-scaling-group-asg" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="https://data.terabox.com/thumbnail/60fc2bdc059922b8468ef20723f6a421?fid=4401547290288-250528-497477940432260&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-Nog0tlOFfrcPULlinQcUmAysrrs%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=102362295374213231&amp;dp-callid=0&amp;time=1667116800&amp;size=c1680_u1050&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" class="popup img-link shimmer"><img src="https://data.terabox.com/thumbnail/60fc2bdc059922b8468ef20723f6a421?fid=4401547290288-250528-497477940432260&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-Nog0tlOFfrcPULlinQcUmAysrrs%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=102362295374213231&amp;dp-callid=0&amp;time=1667116800&amp;size=c1680_u1050&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" alt="" loading="lazy"></a></p><h2 id="sqs-to-decouple-between-appliccation-tiers"><span class="me-2">SQS to decouple between appliccation tiers</span><a href="#sqs-to-decouple-between-appliccation-tiers" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="https://data.terabox.com/thumbnail/f80aa192a0a4dcfaa593961f079adb61?fid=4401547290288-250528-626847050172989&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-qMHNmkaZ9U%2bU7%2f%2bMan0PbbkXzV4%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=103471156007648684&amp;dp-callid=0&amp;time=1667120400&amp;size=c1680_u1050&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" class="popup img-link shimmer"><img src="https://data.terabox.com/thumbnail/f80aa192a0a4dcfaa593961f079adb61?fid=4401547290288-250528-626847050172989&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-qMHNmkaZ9U%2bU7%2f%2bMan0PbbkXzV4%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=103471156007648684&amp;dp-callid=0&amp;time=1667120400&amp;size=c1680_u1050&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" alt="" loading="lazy"></a></p><h2 id="amazon-sqs---security"><span class="me-2">Amazon SQS - Security</span><a href="#amazon-sqs---security" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Encryption<ul><li>In-flight encryption using HTTPS API<li>At rest encryption using KMS keys<li>Client side encrytion if the client wants to perform encryptioon/decrytion itself</ul><li>Access Controls: IAM policies too regulate access to SQS API<li>SQS Access Policies (similiar to S3 bucket policies)<ul><li>Useful for cross account access to SQS queues<li>Useful for allowinng other services (SNS, S3…) to write to an SQS queue</ul></ul><h2 id="sqs-queue-access-policy"><span class="me-2">SQS Queue Access Policy</span><a href="#sqs-queue-access-policy" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Cross Acccount Access<li>Publish S3 Event Notifications to SQS Queue</ul><h2 id="sqs-message-visiblity-timeout"><span class="me-2">SQS Message Visiblity Timeout</span><a href="#sqs-message-visiblity-timeout" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>After a message is polled by a consumer, it becomes invisible to other consumers<li>By default, the “message visibility timeout” is 30 seconds<li>That means the message has 30 seconnds to be processed<li>After the message visibility timeout is over, the message is “visible” in SQS <a href="https://data.terabox.com/thumbnail/f756fc00768fa969d676b2666a2d9de8?fid=4401547290288-250528-188833361974328&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-qcnvC0XfBAT35K3DEt7WJH5vSDY%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=132004244208837930&amp;dp-callid=0&amp;time=1667224800&amp;size=c1680_u1050&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" class="popup img-link shimmer"><img src="https://data.terabox.com/thumbnail/f756fc00768fa969d676b2666a2d9de8?fid=4401547290288-250528-188833361974328&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-qcnvC0XfBAT35K3DEt7WJH5vSDY%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=132004244208837930&amp;dp-callid=0&amp;time=1667224800&amp;size=c1680_u1050&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" alt="" loading="lazy"></a><li>If a message is not processed within the visibility timeout, it will be processed twice<li>A consumer could call the ChangelMessageVisibility API tto get more time<li>If visibility timeout is high (hours), and consumer crashes, re-processing will take ttime<li>If visiblity ttimeouut is too low (seconds), we may get duplicates <a href="https://data.terabox.com/thumbnail/d47c49082dec86f2e22da592a865975e?fid=4401547290288-250528-638498077057569&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-jdlltFCiGrHAJHxoyKhoPQyKWKE%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=132070613337514410&amp;dp-callid=0&amp;time=1667224800&amp;size=c1680_u1050&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" class="popup img-link shimmer"><img src="https://data.terabox.com/thumbnail/d47c49082dec86f2e22da592a865975e?fid=4401547290288-250528-638498077057569&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-jdlltFCiGrHAJHxoyKhoPQyKWKE%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=132070613337514410&amp;dp-callid=0&amp;time=1667224800&amp;size=c1680_u1050&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" alt="" loading="lazy"></a></ul><h2 id="amazon-sqs---dead-letter-queue"><span class="me-2">Amazon SQS - Dead Letter Queue</span><a href="#amazon-sqs---dead-letter-queue" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>If a consumer fails to process a message within the visibility timeout… the message goes back to the queue!<li>We can set a threshold of how manny times a message can go back to the queue<li>After tthe mmaximumreceivves tthreshold is exceeded, the message goes intto a dead lettter queue (DLQ)<li>Userful for debugginng!<li>Make sure to process the messages in the DLQ before they expire:<ul><li>Good to sett a rettenttion oof 14days in the DLQ <a href="https://data.terabox.com/thumbnail/4716a6d1bd945f1672018cecc0dc3c19?fid=4401547290288-250528-253963689416032&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-V4lCvzDh%2byKWkokdmrzD%2fFpcPWE%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=132196486098997097&amp;dp-callid=0&amp;time=1667228400&amp;size=c1680_u1050&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" class="popup img-link shimmer"><img src="https://data.terabox.com/thumbnail/4716a6d1bd945f1672018cecc0dc3c19?fid=4401547290288-250528-253963689416032&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-V4lCvzDh%2byKWkokdmrzD%2fFpcPWE%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=132196486098997097&amp;dp-callid=0&amp;time=1667228400&amp;size=c1680_u1050&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" alt="" loading="lazy"></a></ul></ul><h2 id="sqs-dlq---redrive-to-source"><span class="me-2">SQS DLQ - Redrive to Source</span><a href="#sqs-dlq---redrive-to-source" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Feature to help consume messages in the DLQ to understand what is wrong with them.<li>When our code is fixed, we can redrive the messages from the DLQ backk into the source queue (or any otther queue) inn batches without writing custtom code</ul><h2 id="amazon-sqs---delay-queue"><span class="me-2">Amazon SQS - Delay Queue</span><a href="#amazon-sqs---delay-queue" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Delay a message (consummers don’t see it immediately) up to 15 minuttes<li>Defaultt is 0 secconnds (message is available rightt away)<li>Can set a defaultt at queue level<li>Can override tthe defaultt o sennd using the DelaySecccond parameters</ul><h2 id="amazon-sqs---long-polling"><span class="me-2">Amazon SQS - Long Polling</span><a href="#amazon-sqs---long-polling" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>When a consumer requests messages from the queue, it can optioally “wait” for messages to arrive if tthere are nonne in the queue<li>This is called long pollinng<li>LongPolling dereases the nuumber of API calls made tto SQS while increasign tthe efficiency and reduinng lattenccy of your applicationn<li>The wait time can be between 1 se tto 20 sec (20 sec preferable)<li>Lonng polling is preferable to short polling<li>long polling level using waittimeseconnds</ul><h2 id="amazon-sqs--dead-letter-queue"><span class="me-2">Amazon SQS – Dead Letter Queue</span><a href="#amazon-sqs--dead-letter-queue" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>If a consumer fails to process a message within the Visibility Timeout…<li>We can set a threshold of how many times a message can go back to the queue<li>After the maximumReceives threshold is exceeded, the message goes into a dead letter queue (DLQ)<li>Useful for debugging!<li>Make sure to process the message in the DLQ before they expire:<ul><li>Good to set a retention of <strong>14days</strong> in the DLQ</ul></ul><h2 id="sqs-dlq--redrive-to-source"><span class="me-2">SQS DLQ – Redrive to Source</span><a href="#sqs-dlq--redrive-to-source" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Redrive to Source<li><strong>Feature to help consume messages</strong> in the DLQ to understand what is wrong with them<li>When our code is fixed, we can redrive the messages from the DLQ back into the source queue (or any other queue) in batches without writing custom code</ul><h2 id="amazon-sqs--delay-queue"><span class="me-2">Amazon SQS – Delay Queue</span><a href="#amazon-sqs--delay-queue" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Delay a message up to 15minutes<li>Default is 0 seconds<li>Can set a default at queue level<li>Can override the default on send using the delayseconds parameter</ul><h2 id="amazon-sqs---long-polling-1"><span class="me-2">Amazon SQS - Long Polling</span><a href="#amazon-sqs---long-polling-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>When a consumer requests messages from the queue, it can optionally “wait” for messages to arrive if there are none in the queue<li>This is called long polling<li>Longpolling decrease the number of API calls mafe to SQS while increasing the<li>The wait time can be between 1 sc to 20 sec<li>Long polling is preferable to short polling<li>Long polling can be enabled at the queue level or at the API level using WaitTimeSeconds</ul><h2 id="sqs--request-response-systems"><span class="me-2">SQS – Request-Response Systems</span><a href="#sqs--request-response-systems" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>To implement this pattern: use the SQS Temporary Queue Client<li>It leverages virtual queues instead of creating / deleting SQS queues (cost-effective) <a href="https://data.terabox.com/thumbnail/dbd7823be2ea09d4c6646487427c332e?fid=4401547290288-250528-836653485996578&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-Tn0aACsr41dXjKCENJmAIots4Dw%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=146796765169662898&amp;dp-callid=0&amp;time=1667282400&amp;size=c1920_u1080&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" class="popup img-link shimmer"><img src="https://data.terabox.com/thumbnail/dbd7823be2ea09d4c6646487427c332e?fid=4401547290288-250528-836653485996578&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-Tn0aACsr41dXjKCENJmAIots4Dw%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=146796765169662898&amp;dp-callid=0&amp;time=1667282400&amp;size=c1920_u1080&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" alt="" loading="lazy"></a></ul><h2 id="amazon-sqs--fifo-queue"><span class="me-2">Amazon SQS – FIFO Queue</span><a href="#amazon-sqs--fifo-queue" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>FIFO = First In First Out (ordering of messages in the queue)<li>Limited throughput: 300 msg/s without batching, 3000 msg/s with<li>Exactly-once send capability (by removing duplicates)<li>Messages are processed in order by the consumer</ul><h2 id="kinesis-overview"><span class="me-2">Kinesis Overview</span><a href="#kinesis-overview" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Makes it easy to collect, process, and analyze streaming data in real-time<li>Ingest real-time data such as: Application logs, Metrics, Website clickstreams, IoT telemetry data…<li>Kinesis <strong>Data Streams</strong>: capture, process, and store data streams<li>Kinesis <strong>Data Firehose</strong>: load data streams into AWS data stores<li>Kinesis <strong>Data Analytics</strong>: analyze data streams with SQL or Apache Flink<li>Kinesis <strong>Video Streams</strong>: capture, process, and store video streams</ul><h2 id="kinesis-data-streams"><span class="me-2">Kinesis Data Streams</span><a href="#kinesis-data-streams" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="https://data.terabox.com/thumbnail/53158a28c623e5784fb1ecc95aa40bae?fid=4401547290288-250528-888144365073549&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-nUHbZG%2bm8Up4v28zawpO92Bhg0A%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=148630191436730620&amp;dp-callid=0&amp;time=1667289600&amp;size=c1920_u1080&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" class="popup img-link shimmer"><img src="https://data.terabox.com/thumbnail/53158a28c623e5784fb1ecc95aa40bae?fid=4401547290288-250528-888144365073549&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-nUHbZG%2bm8Up4v28zawpO92Bhg0A%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=148630191436730620&amp;dp-callid=0&amp;time=1667289600&amp;size=c1920_u1080&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" alt="" loading="lazy"></a></p><ul><li>Retention between 1 day to 365 days<li>Ability to reprocess (replay) data<li>Once data is inserted in Kinesis, it can’t be deleted (immutability)<li>Data that shares the same partition goes to the same shard (ordering)<li>Producers: AWS SDK, Kinesis Producer Library(KPL), Kinesis Agent<li>Consumers:<ul><li>Write your own: Kinesis Client Library (KCL), AWS SDK<li>Managed: AWS Lambda, Kinesis Data Firehose, Kinesis Data Analytics</ul></ul><h2 id="kinesis-data-streams--capacity-modes"><span class="me-2">Kinesis Data Streams – Capacity Modes</span><a href="#kinesis-data-streams--capacity-modes" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Provisioned mode:<ul><li>You choose the number of shards provisioned, scale manually or using API<li>Each shard get 1MB/s in (or 1000 records per second)<li>Each shard get 2MB/s out (classic or enhanced fan-out consumer)<li>You pay per shard provisioned per hour</ul><li>On-demand mode:<ul><li>No need to provision or manage the capacity<li>Default capacity provisioned (4 MB/s in or 4000 records per second)<li>Scales automatically based on observed throughput peak during the last 30days<li>Pay per stream per hour &amp; data in/out per GB</ul></ul><h2 id="kinesis-data-firehose"><span class="me-2">Kinesis Data Firehose</span><a href="#kinesis-data-firehose" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="https://data.terabox.com/thumbnail/a87fe08448661bf47728bf5964cdb514?fid=4401547290288-250528-28993844855522&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-BXS0G9aKyYcpu5C%2bxeTeU4644sE%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=148365350066619248&amp;dp-callid=0&amp;time=1667286000&amp;size=c1920_u1080&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" class="popup img-link shimmer"><img src="https://data.terabox.com/thumbnail/a87fe08448661bf47728bf5964cdb514?fid=4401547290288-250528-28993844855522&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-BXS0G9aKyYcpu5C%2bxeTeU4644sE%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=148365350066619248&amp;dp-callid=0&amp;time=1667286000&amp;size=c1920_u1080&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" alt="" loading="lazy"></a></p><ul><li>Fully managed service, no administration, automatic scaling, serverless<ul><li>AWS: Redshift / Amazon S3 / ElasticSearch<li>3rd party partner: Splunk / MongoDB / DataDog / NewRelic / …<li>Custom: send to any HTTP endpoint</ul><li>Pay for data going through Firehose<li><strong>Near Real Time</strong><ul><li>60 seconds latency minimum for non full batches<li>Or minimum 32 MB of data at a time</ul><li>Supports many data formats, conversions, transformations, compression<li>Supports custom data transformations using AWS Lambda<li>Can send failed or all data to a backup <strong>S3 bucket</strong></ul><h2 id="kinesis-data-streams-vs-firehose"><span class="me-2">Kinesis Data Streams vs Firehose</span><a href="#kinesis-data-streams-vs-firehose" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="kinesis-data-streams-1"><span class="me-2">Kinesis Data Streams</span><a href="#kinesis-data-streams-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Streaming service for ingest at scale<li>Write custom code (producer / consumer)<li>Realtime (~200ms)<li>Manage scaling (shard splitting / merging)<li>Data storage for 1 to 365 days<li>Suports replay capability</ul><h3 id="kinesis-data-firehose-1"><span class="me-2">Kinesis Data Firehose</span><a href="#kinesis-data-firehose-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Load streaming data into S3 / Redshift / ES / 3 rd party / custom HTTP<li>Fully managed<li>Near real-time (buffer time min. 60 sec)<li>Automatic scaling<li>No data storage<li>Doesn’t support replay capability</ul><h2 id="kinesis-data-analytics-sql-application"><span class="me-2">Kinesis Data Analytics (SQL application)</span><a href="#kinesis-data-analytics-sql-application" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="https://data.terabox.com/thumbnail/60d525fa51afec1e7694a5080ceac9f0?fid=4401547290288-250528-913877153385398&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-Cp1mXiL7X1h5dzf%2fBuj2fjgtGnw%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=148621121388058704&amp;dp-callid=0&amp;time=1667289600&amp;size=c1920_u1080&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" class="popup img-link shimmer"><img src="https://data.terabox.com/thumbnail/60d525fa51afec1e7694a5080ceac9f0?fid=4401547290288-250528-913877153385398&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-Cp1mXiL7X1h5dzf%2fBuj2fjgtGnw%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=148621121388058704&amp;dp-callid=0&amp;time=1667289600&amp;size=c1920_u1080&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" alt="" loading="lazy"></a></p><ul><li>Perform real-time analytics on <strong>Kinesis Streams</strong> using SQL<li>Fully managed, no servers to provision<li>Automatic scaling<li>Real-time analytics<li>Pay for actual consumption rate<li>Can create streams out of the real-time queries<li>Use cases:<ul><li>Time-series analytics<li>Real-time dashboards<li>Real-time metrics</ul></ul><h2 id="ordering-data-into-kinesis"><span class="me-2">Ordering data into Kinesis</span><a href="#ordering-data-into-kinesis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Imagine you have 100 trucks (truck_1, truck_2,.., truck_100) on the road sending their GPS positions regularly into AWS<li>You want to consume the data in order for each truck, so that you can track their movment accurately<li>How should you send that data into Kinesis?<li>Answer: send using a “Partition Key” value of the “truck_id”<li>The same key will always go to the same shard</ul><h2 id="ordering-data-into-sqs"><span class="me-2">Ordering data into SQS</span><a href="#ordering-data-into-sqs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>For SQS standard, there is no ordering<li>For SQS FIFO, if you don’t use a Group ID, messages are consumed in the order they are sent, with only one consumer<li>You want to scale the number of consumers, but you want messages to be “grouped” when they are related to each other<li>Then you use a Group ID (similar to Partition Key in Kinesis)</ul><h2 id="kinesis-vs-sqs-ordering"><span class="me-2">Kinesis vs SQS ordering</span><a href="#kinesis-vs-sqs-ordering" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Let’s assume 100 trucks, 5 kinesis shards, 1 SQS FIFO<li>Kinesis Data Streams: (500 consumer)<ul><li>On average you’ll have 20 trucks per shard<li>Trucks will have their data ordered within each shard<li>The maximum amount of consumers in parallel we can have is 5<li>Can receive up to 5 MB/s of data</ul><li>SQS FIFO<ul><li>You only have one SQS FIFO queue<li>You will have 100 Group ID<li>You can have up to 100 Consumers (due to the 100 Group ID)<li>You have up to 300 messages per second (or 3000 if using batching) <a href="https://data.terabox.com/thumbnail/f346f844d5d9db1b8c51b1ce76f4e060?fid=4401547290288-250528-306468149542926&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-%2bkG8vTfYToNs7SuxQkLzqJTGRUQ%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=149575350169314786&amp;dp-callid=0&amp;time=1667293200&amp;size=c1920_u1080&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" class="popup img-link shimmer"><img src="https://data.terabox.com/thumbnail/f346f844d5d9db1b8c51b1ce76f4e060?fid=4401547290288-250528-306468149542926&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-%2bkG8vTfYToNs7SuxQkLzqJTGRUQ%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=149575350169314786&amp;dp-callid=0&amp;time=1667293200&amp;size=c1920_u1080&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" alt="" loading="lazy"></a> <a href="https://data.terabox.com/thumbnail/b1fad88a96d1d76899606b95a11ce278?fid=4401547290288-250528-796537850720769&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-m8ZdL15W5%2bcMXJW4bAfPrs5XzYk%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=149918803408287026&amp;dp-callid=0&amp;time=1667293200&amp;size=c1920_u1080&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" class="popup img-link shimmer"><img src="https://data.terabox.com/thumbnail/b1fad88a96d1d76899606b95a11ce278?fid=4401547290288-250528-796537850720769&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-m8ZdL15W5%2bcMXJW4bAfPrs5XzYk%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=149918803408287026&amp;dp-callid=0&amp;time=1667293200&amp;size=c1920_u1080&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" alt="" loading="lazy"></a></ul></ul><h2 id="amazon-sns"><span class="me-2">Amazon SNS</span><a href="#amazon-sns" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>What if you want to send one message to many receivers? <a href="https://data.terabox.com/thumbnail/61a5422e119285c0aa117312c5d96dc4?fid=4401547290288-250528-226564793143734&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-EZJZQCXmS8eP%2bsl5h0BjkWvme9M%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=149426414854930996&amp;dp-callid=0&amp;time=1667289600&amp;size=c1920_u1080&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" class="popup img-link shimmer"><img src="https://data.terabox.com/thumbnail/61a5422e119285c0aa117312c5d96dc4?fid=4401547290288-250528-226564793143734&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-EZJZQCXmS8eP%2bsl5h0BjkWvme9M%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=149426414854930996&amp;dp-callid=0&amp;time=1667289600&amp;size=c1920_u1080&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" alt="" loading="lazy"></a><li>The <strong>“event producer”</strong> only sends message to one SNS topic<li>As many “event receivers” (subscriptions) as we want to listen to the SNS topic notifications<li>Each subscriber to the topic will get all the messages (note: new feature to filter messages)<li>Up to 12,500,000 subscriptions per topic<li>100,000 topics limit</ul><h2 id="sns-integrates-with-a-lot-of-aws-services"><span class="me-2">SNS integrates with a lot of AWS services</span><a href="#sns-integrates-with-a-lot-of-aws-services" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Many AWS services can send data directly to SNS for notifications</ul><h2 id="amazon-sns--how-to-publish"><span class="me-2">Amazon SNS – How to publish</span><a href="#amazon-sns--how-to-publish" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Topic Publish (using the SDK)<ul><li>Create a topic<li>Create a subscription (or many)<li>Publish to the topic</ul><li>Direct Publish (for mobile apps SDK)<ul><li>Create a platform application<li>Create a platform endpoint<li>Publish to the platform endpoint<li>Works with Google GCM, Apple APNS, Amazon ADM…</ul></ul><h2 id="amazon-sns--security"><span class="me-2">Amazon SNS – Security</span><a href="#amazon-sns--security" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Encryption:<ul><li>In-flight encryption using HTTPS API<li>At-rest encryption using KMS keys<li>Client-side encryption if the client wants to perform encryption/decryption itself</ul><li>Access Controls: IAM policies to regulate access to the SNS API<li>SNS Access Policies (similar to S3 bucket policies)<ul><li>Useful for cross-account access to SNS topics<li>Useful for allowing other services ( S3…) to write to an SNS topic</ul></ul><h2 id="sns--sqs-fan-out"><span class="me-2">SNS + SQS: Fan Out</span><a href="#sns--sqs-fan-out" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Push once in SNS, receive in all SQS queues that are subscribers<li>Fully decoupled, no data loss<li>SQS allows for: data persistence, delayed processing and retries of work<li>Ability to add more SQS subscribers over time<li>Make sure your SQS queue accesss policy allows for SNS to write</ul><h2 id="application-s3-events-to-multiple-queues"><span class="me-2">Application: S3 Events to multiple queues</span><a href="#application-s3-events-to-multiple-queues" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>For the same combination of: event type (e.g. object create) and prefix (e.g. images/) you can only have one S3 Event rule<li>If you want to send the same S3 event to many SQS queues, use fan-out <a href="https://data.terabox.com/thumbnail/3418d292f1d06f3ec06d318c2287e826?fid=4401547290288-250528-994038393814877&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-EIAdlE7tgwvm4YaSWOeawoN5lYM%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=149836234918496344&amp;dp-callid=0&amp;time=1667293200&amp;size=c1920_u1080&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" class="popup img-link shimmer"><img src="https://data.terabox.com/thumbnail/3418d292f1d06f3ec06d318c2287e826?fid=4401547290288-250528-994038393814877&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-EIAdlE7tgwvm4YaSWOeawoN5lYM%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=149836234918496344&amp;dp-callid=0&amp;time=1667293200&amp;size=c1920_u1080&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" alt="" loading="lazy"></a></ul><h2 id="application-sns-to-amazon-s3-through-kinesis-data-firehose"><span class="me-2">Application: SNS to Amazon S3 through Kinesis Data Firehose</span><a href="#application-sns-to-amazon-s3-through-kinesis-data-firehose" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>SNS can send to Kinesis and therefore we can have the following solutions architecture: <a href="https://data.terabox.com/thumbnail/07787eb9a8b13863a337796e6739c6c1?fid=4401547290288-250528-698671128515364&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-CJlL04CDEPUSicRlQAlTWx5arOg%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=149918803408287026&amp;dp-callid=0&amp;time=1667293200&amp;size=c1920_u1080&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" class="popup img-link shimmer"><img src="https://data.terabox.com/thumbnail/07787eb9a8b13863a337796e6739c6c1?fid=4401547290288-250528-698671128515364&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-CJlL04CDEPUSicRlQAlTWx5arOg%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=149918803408287026&amp;dp-callid=0&amp;time=1667293200&amp;size=c1920_u1080&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" alt="" loading="lazy"></a></ul><h2 id="amazon-sns--fifo-topic"><span class="me-2">Amazon SNS – FIFO Topic</span><a href="#amazon-sns--fifo-topic" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>FIFO = First In First Out (ordering of messages in the topic)<li>Similar features as SQS FIFO:<ul><li><strong>Ordering</strong> by message group ID (all messages in the same group are ordred)<li><strong>Deduplication</strong> using a Deduplication ID or Content Based Deduplication</ul><li>Can only have SQS FIFO queues as subscribers<li>Limited throughput (same throughput as SQS FIFO)</ul><h2 id="sns-fifo--sqs-fifo-fan-out"><span class="me-2">SNS FIFO + SQS FIFO: Fan Out</span><a href="#sns-fifo--sqs-fifo-fan-out" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>In case you need fan out + ordering + deduplication <a href="https://data.terabox.com/thumbnail/3ea6ea025180be1a376c8c59fdeff11b?fid=4401547290288-250528-41769958245629&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-f%2b2tgUXgOJUBaUNFca8rXHJk53A%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=150238647327959985&amp;dp-callid=0&amp;time=1667293200&amp;size=c1920_u1080&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" class="popup img-link shimmer"><img src="https://data.terabox.com/thumbnail/3ea6ea025180be1a376c8c59fdeff11b?fid=4401547290288-250528-41769958245629&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-f%2b2tgUXgOJUBaUNFca8rXHJk53A%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=150238647327959985&amp;dp-callid=0&amp;time=1667293200&amp;size=c1920_u1080&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" alt="" loading="lazy"></a></ul><h2 id="sns--message-filtering"><span class="me-2">SNS – Message Filtering</span><a href="#sns--message-filtering" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>JSON policy used to filter messages sent to SNS topic’s subscriptions<li>If a subscription doesn’t have a filter policy, it receives every message <a href="https://data.terabox.com/thumbnail/22f88eebfb31c930c37934b8fdab6166?fid=4401547290288-250528-336701414978434&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-Q%2bh2vb3%2fyR305uc1cXway1zfF28%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=150295095105082411&amp;dp-callid=0&amp;time=1667293200&amp;size=c1920_u1080&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" class="popup img-link shimmer"><img src="https://data.terabox.com/thumbnail/22f88eebfb31c930c37934b8fdab6166?fid=4401547290288-250528-336701414978434&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-Q%2bh2vb3%2fyR305uc1cXway1zfF28%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=150295095105082411&amp;dp-callid=0&amp;time=1667293200&amp;size=c1920_u1080&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" alt="" loading="lazy"></a></ul><h2 id="sqs-vs-sns-vs-kinesis"><span class="me-2">SQS vs SNS vs Kinesis</span><a href="#sqs-vs-sns-vs-kinesis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="sqs"><span class="me-2">SQS</span><a href="#sqs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Consumer “pull data”<li>Data is deleted after being consumed<li>Can have as many workers (consumers) as we want<li>No need to provision throughput<li>Ordering guarantes only on FIFO queues<li>Individual message delay capability</ul><h3 id="sns"><span class="me-2">SNS</span><a href="#sns" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Push data to many subscribers<li>Up to 12500000 subcribers<li>Data is not persisted (lost if not delivered)<li>Pub/sub<li>Up to 100000 topics<li>No need to provision throughput<li>Integrates with SQS for fan-out architecture pattern<li>FIFO capability for SQS FIFO<h2 id="kinesis"><span class="me-2">Kinesis</span><a href="#kinesis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><li>Standard: Pull data<ul><li>2Mb per shard</ul><li>Enhanced-fan out: push data<ul><li>2MB per shard per consumer</ul><li>Possibility to replay data<li>Meant for real-time big data, analytics and ETL<li>Ordering at the shard level<li>Data expires aftr X days<li>Provisioned mode or on-demand capacity mode</ul><h2 id="amazon-mq"><span class="me-2">Amazon MQ</span><a href="#amazon-mq" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>SQS, SNS are “cloud-native” service, and they’re using proprietary protocols from AWS<li>Traditional applications running from on-premises may use open protocols such as: MQTT, AMQP, STOMP, Openwire, WSS<li>When migrating to the cloud, instead of re-engineering the application to use SQS and SNS, we can use Amazon MQ<li>Amazon MQ = managed Apache ActiveMQ<li>Amazon MQ doesn’t “scale” as much as SQS / SNS<li>Amazon MQ runs on a dedicated machine, can run in HA with failover<li>Amazon MQ has both queue feature (~SQS) and topic features (~SNS)</ul><h2 id="amazon-mq--high-availability"><span class="me-2">Amazon MQ – High Availability</span><a href="#amazon-mq--high-availability" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="https://data.terabox.com/thumbnail/e405f51c992247649bff966cc1e5e2ee?fid=4401547290288-250528-131705074839729&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-eqMIRYs%2fxykOOR7iRUOoprbAVzw%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=151478974774550761&amp;dp-callid=0&amp;time=1667300400&amp;size=c1920_u1080&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" class="popup img-link shimmer"><img src="https://data.terabox.com/thumbnail/e405f51c992247649bff966cc1e5e2ee?fid=4401547290288-250528-131705074839729&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-eqMIRYs%2fxykOOR7iRUOoprbAVzw%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=151478974774550761&amp;dp-callid=0&amp;time=1667300400&amp;size=c1920_u1080&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" alt="" loading="lazy"></a></p><h1 id="serverless-and-application-services">SERVERLESS AND APPLICATION SERVICES</h1><ul><li>Tiered Architecture<li>When we start deploying multiple applications, they will inevitably need to communicate with one another.<li>There are two patterns of application communication.<ul><li>Evolving with queues<li>Event-driven architecture</ul></ul><h2 id="amazon-sqs--standard-queue"><span class="me-2">Amazon SQS – Standard Queue</span><a href="#amazon-sqs--standard-queue" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Oldest offering (over 10 years old)<li>Fully managed service, used to decouple applications<li>Attributes:<ul><li>Unlimited throughput, unlimited number of messages in queue<li>Default retention of messages: 4 days, maximum of 14 days<li>Low latency (&lt;10 ms on publish and receive)<li>Limitation of 256KB per message sent</ul><li>Can have duplicate messages (at least once delivery, occasionally)<li>Can have out of order messages (best effort ordering)</ul><h2 id="sqs--producing-messages"><span class="me-2">SQS – Producing Messages</span><a href="#sqs--producing-messages" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Produced to SQS using the SDK (SendMessage API)<li>The message is persisted in SQS until a consumer deletes it<li>Message retention: default 4 days, up to 14 days<li>Example: send an order to be processed<ul><li>Order id<li>Customer id<li>Any attributes you want</ul><li>SQS standard: unlimited throughput</ul><h2 id="sqs--consuming-messages"><span class="me-2">SQS – Consuming Messages</span><a href="#sqs--consuming-messages" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Consumers (running on EC2 instances, servers, or AWS Lambda)…<li>Poll SQS for messages (receive up to 10 messages at a time)<li>Process the messages (example: insert the message into an RDS database)<li>Delete the messages using the DeleteMessage API</ul><h2 id="lambda-function-as-a-service"><span class="me-2">Lambda: function as a service</span><a href="#lambda-function-as-a-service" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>- You are billed for the duration that a function runs
- The environment has a direct memory (indirect CPU) allocation
- Deployment a package with 50MB zipped and 250MB unzipped
- 512 MB storage available as /tmp
- Serverless application (S3, API Gateway, Lambda)
- File Processing (S3, S3 event, lamba)
- Database Triggers (DynamoDB, Streams, Lambda)
- Serverless CROn (EventBrige/CWEvents + Lambda)
- Realtime Stream Data Processing (kinesis + Lambda)
</pre></table></code></div></div><h2 id="lambda-in-depth"><span class="me-2">Lambda in depth:</span><a href="#lambda-in-depth" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>- Public Lambda:
![](https://data.terabox.com/thumbnail/9fb8e7f5d4deb514c210c436daa33b68?fid=4401547290288-250528-754626766169061&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-AyXAee6ddgI%2bVvNASA%2fyuIDC100%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=125173180413113238&amp;dp-callid=0&amp;time=1667199600&amp;size=c1920_u1080&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1)
- Private Lambda:
![](https://data.terabox.com/thumbnail/33d179bf393395941a01511d2a744ce3?fid=4401547290288-250528-1097958099823614&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-45Ti2FPZBOQcIaJFI2fcCqPuJCU%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=125190523939933141&amp;dp-callid=0&amp;time=1667199600&amp;size=c1920_u1080&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1)
    - Lambda run in VPC obey all VPC networking rules
- Lambda security:
    - Lambda execution roles are IAM roles attached to lambda functions which control the permissions the lambda function receives ...
    - Lambda resource policy controls what services and accounts can invoke lambda functions
- Lambda Logging:
    - Lambda uses Cloudwatch, cloudwatch logs &amp; x-ray
    - Logs from lambda executions - cloudwatchlogs
    - Metrics - invocation success/failure, retries, latency ... stored in cloudwatch
    - lambda can be integrated with x-ray for distributed tracing
    - Cloudwatch logs requires permissions via execution role
</pre></table></code></div></div><h2 id="lambda-in-depth-invocation"><span class="me-2">Lambda in depth: Invocation</span><a href="#lambda-in-depth-invocation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Invocation:<li>Synchronous<ul><li>cli / api, client communicates with APIGW , proxied to lambda function</ul><li>Asynchronous (typically used when AWS services invoke lambda functions)<ul><li>S3 isn’t waitting for any kind of response. The event is generated and S3 stops tracking<li>If processing of the event fails, lambda will retry between 0 and 2 time (configurable). Lambda handles the retry logic<li>The lambda function needs to be idempotent reprocessing a result should have the same end state <a href="https://data.terabox.com/thumbnail/287d192ccaaa33ab70bd39efe284f587?fid=4401547290288-250528-848637065930323&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-cQd1uCN6L3W8PuVn%2btcfZB87%2fM8%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=125597516564879274&amp;dp-callid=0&amp;time=1667203200&amp;size=c1920_u1080&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" class="popup img-link shimmer"><img src="https://data.terabox.com/thumbnail/287d192ccaaa33ab70bd39efe284f587?fid=4401547290288-250528-848637065930323&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-cQd1uCN6L3W8PuVn%2btcfZB87%2fM8%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=125597516564879274&amp;dp-callid=0&amp;time=1667203200&amp;size=c1920_u1080&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" alt="" loading="lazy"></a></ul><li>Kinesis data stream: producers(telemetry) <a href="https://data.terabox.com/thumbnail/28aa6998b0ebdef94b4e16f253471770?fid=4401547290288-250528-702564787382654&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-kQOc6hfw13wsrP9Vk8%2br4zTlQeA%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=125670327781297890&amp;dp-callid=0&amp;time=1667203200&amp;size=c1920_u1080&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" class="popup img-link shimmer"><img src="https://data.terabox.com/thumbnail/28aa6998b0ebdef94b4e16f253471770?fid=4401547290288-250528-702564787382654&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-kQOc6hfw13wsrP9Vk8%2br4zTlQeA%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=125670327781297890&amp;dp-callid=0&amp;time=1667203200&amp;size=c1920_u1080&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" alt="" loading="lazy"></a><li>An execution context is the environment a lambda function run in. A cold start is a full creation and configuration including function code dowload. <a href="https://data.terabox.com/thumbnail/a01705e28f64e433d11b34650c680af9?fid=4401547290288-250528-926045713650794&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-LpiObhVLwT29GOMoxt1fK19ih4M%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=126228460675791421&amp;dp-callid=0&amp;time=1667203200&amp;size=c1920_u1080&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" class="popup img-link shimmer"><img src="https://data.terabox.com/thumbnail/a01705e28f64e433d11b34650c680af9?fid=4401547290288-250528-926045713650794&amp;rt=pr&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-LpiObhVLwT29GOMoxt1fK19ih4M%3d&amp;expires=8h&amp;chkbd=0&amp;chkv=0&amp;dp-logid=126228460675791421&amp;dp-callid=0&amp;time=1667203200&amp;size=c1920_u1080&amp;quality=90&amp;vuk=4401547290288&amp;ft=image&amp;autopolicy=1" alt="" loading="lazy"></a></ul><h2 id="cloudwatch-events-and-eventbridge"><span class="me-2">Cloudwatch events and eventbridge</span><a href="#cloudwatch-events-and-eventbridge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>If X happen, or at Y times .. do Z<li>Eventbrigde is cloudwatch api v2<li>a default event bus for account<li>cloudwatch event has only one bus<li>eventbrigde have additional bus<li>rules match event<li>route the events to +1 targets as Lambda CloudWatch Events and EventBridge have visibility over events generated by supported AWS services within an account. They can monitor the default account event bus - and pattern match events flowing through and deliver these events to multiple targets. They are also the source of scheduled events which can perform certain actions at certain times of day, days of the week, or multiple combinations of both - using the Unix CRON time expression format. Both services are one way how <strong>event driven architectures</strong> can be implemented within AWS.</ul><h2 id="sqs--multiple-ec2-instances-consumers"><span class="me-2">SQS – Multiple EC2 Instances Consumers</span><a href="#sqs--multiple-ec2-instances-consumers" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Consumers receive and process messages in parallel<li>At least once delivery<li>Best-effort message ordering<li>Consumers delete messages after processing them<li>We can scale consumers horizontally to improve throughput of processing</ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/fullstack/">Fullstack</a>, <a href="/categories/architect/">Architect</a>, <a href="/categories/aws/">AWS</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/aws/" class="post-tag no-text-decoration" >aws</a> <a href="/tags/sqs/" class="post-tag no-text-decoration" >sqs</a> <a href="/tags/sns/" class="post-tag no-text-decoration" >sns</a> <a href="/tags/serverless/" class="post-tag no-text-decoration" >serverless</a> <a href="/tags/service/" class="post-tag no-text-decoration" >service</a> <a href="/tags/sts/" class="post-tag no-text-decoration" >sts</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/AdHuybinh" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/alz.ailove" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=AWS%20Api%20gateway,%20Lambda,%20Serverless,%20and%20Services%20part%20I%20-%20Programmer%20From%20Zero%20To%20Mountaint&url=https%3A%2F%2Fzmerrychristmas.github.io%2Fposts%2Faws-api-gateway-lambda-serverless-and-services%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/in/b%C3%ACnh-nguy%E1%BB%85n-75312a7b/" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/solid-principles-and-solid-in-frameworks/">SOLID principles, and SOLID in frameworks (part 1)</a><li class="text-truncate lh-lg"> <a href="/posts/nodejs-concept/">Node.JS concept</a><li class="text-truncate lh-lg"> <a href="/posts/text-and-typography/">Text and Typography</a><li class="text-truncate lh-lg"> <a href="/posts/getting-started/">Getting Started</a><li class="text-truncate lh-lg"> <a href="/posts/enable-google-pv/">Enable Google Page Views</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/rails/">rails</a> <a class="post-tag btn btn-outline-primary" href="/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/tags/javascript/">javascript</a> <a class="post-tag btn btn-outline-primary" href="/tags/ruby/">ruby</a> <a class="post-tag btn btn-outline-primary" href="/tags/api/">api</a> <a class="post-tag btn btn-outline-primary" href="/tags/aurora/">aurora</a> <a class="post-tag btn btn-outline-primary" href="/tags/jekyll/">jekyll</a> <a class="post-tag btn btn-outline-primary" href="/tags/laravel/">laravel</a> <a class="post-tag btn btn-outline-primary" href="/tags/php/">php</a> <a class="post-tag btn btn-outline-primary" href="/tags/python/">python</a></div></section></div><section id="toc-wrapper" class="ps-0 pe-4"><h2 class="panel-heading ps-3 pt-2 mb-2">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/aws-certified-solutions-architect-associate-saa-c03-exam-guide/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1670000400" data-df="ll" > Dec 3, 2022 </time><h4 class="pt-0 my-2">AWS Certified Solutions Architect - Associate (SAA-C03) Exam Guide</h4><div class="text-muted"><p> Content outline This exam guide includes weightings, test domains, and task statements for the exam. It is not a comprehensive listing of the content on the exam. However, additional context for ea...</p></div></div></a></article><article class="col"> <a href="/posts/aws-advance-alb-clb-rds-and-aurora-part-2/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1670086800" data-df="ll" > Dec 4, 2022 </time><h4 class="pt-0 my-2">AWS Advance: RDS</h4><div class="text-muted"><p> RDS AWS RDS Overview RDS stannds for Relatioal Database service It’s a managed DB service for DB use SQL as a query language. It allow you to create databases in the cloud that are managed b...</p></div></div></a></article><article class="col"> <a href="/posts/aws-advance/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1670000400" data-df="ll" > Dec 3, 2022 </time><h4 class="pt-0 my-2">AWS Advance: Auto scaling and auto load balancer</h4><div class="text-muted"><p> SSL/TLS - Basics An SSL Certificate allow traffic between your clients and your load balancer to be encrypted in transit (i-flight encryption) SSL refers to Secure Soccket Layeer, used to encr...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/aws-concept-and-classic-solutions-architecture/" class="btn btn-outline-primary" aria-label="Older" ><p>AWS concept and classic Solutions Architecture</p></a><div class="btn btn-outline-primary disabled" aria-label="Newer"><p>-</p></div></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2024</time> <a href="https://twitter.com/username">Leo đẹp trai</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/rails/">rails</a> <a class="post-tag btn btn-outline-primary" href="/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/tags/javascript/">javascript</a> <a class="post-tag btn btn-outline-primary" href="/tags/ruby/">ruby</a> <a class="post-tag btn btn-outline-primary" href="/tags/api/">api</a> <a class="post-tag btn btn-outline-primary" href="/tags/aurora/">aurora</a> <a class="post-tag btn btn-outline-primary" href="/tags/jekyll/">jekyll</a> <a class="post-tag btn btn-outline-primary" href="/tags/laravel/">laravel</a> <a class="post-tag btn btn-outline-primary" href="/tags/php/">php</a> <a class="post-tag btn btn-outline-primary" href="/tags/python/">python</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/en.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js,npm/tocbot@4.25.0/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/assets/js/dist/app.min.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-S57T0PJRJG"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-S57T0PJRJG'); }); </script> <script> /* Note: dependent library will be loaded in `js-selector.html` */ SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
