<!doctype html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="How to build a Shortened URL By Ruby On Rails like Bitly or Twitter" /><meta name="author" content="Leo đẹp trai" /><meta property="og:locale" content="en_US" /><meta name="description" content="How to build a Shortened URL By Ruby On Rails like Bitly or Twitter Give a website shortenedUrl to convert longURL to short URL with alpha lexigraphy encoded/decoded response to User. Give two endpoint encoded decoded Extra default enpoint is index, and retore lasted encoded url About algorithm used on website. I use Bijective algorithm to make a alpha lexigraphy short url. Give rate limit process to request IP and prevent attack vector. I was use gem rack-attack for this case to handle limit request per IP is 5 request to 2 second. other wise, better to authentic user before they use api. To do this prevent, can implement a mechanism authentic by a system by api key for user indetify and in session. System was give an URL with a unique shortURL to decrease weight in database and open scale up if have mutilple dabase installed. To prepare for scale up: 1. Give a better cache system support Rate limit. 2. With URL was created before, we change to operation select instead create same URL. 3. Given a load ballancing to suppot this load is even better than server serve every single request. 4. Architecture from Monolith or micro service and under control of load balancing give us a good reputation. Install System Ruby version ^2.5~3.0 Rails rack-attack gem Rspec factory_bot_rails faker" /><meta property="og:description" content="How to build a Shortened URL By Ruby On Rails like Bitly or Twitter Give a website shortenedUrl to convert longURL to short URL with alpha lexigraphy encoded/decoded response to User. Give two endpoint encoded decoded Extra default enpoint is index, and retore lasted encoded url About algorithm used on website. I use Bijective algorithm to make a alpha lexigraphy short url. Give rate limit process to request IP and prevent attack vector. I was use gem rack-attack for this case to handle limit request per IP is 5 request to 2 second. other wise, better to authentic user before they use api. To do this prevent, can implement a mechanism authentic by a system by api key for user indetify and in session. System was give an URL with a unique shortURL to decrease weight in database and open scale up if have mutilple dabase installed. To prepare for scale up: 1. Give a better cache system support Rate limit. 2. With URL was created before, we change to operation select instead create same URL. 3. Given a load ballancing to suppot this load is even better than server serve every single request. 4. Architecture from Monolith or micro service and under control of load balancing give us a good reputation. Install System Ruby version ^2.5~3.0 Rails rack-attack gem Rspec factory_bot_rails faker" /><link rel="canonical" href="https://zmerrychristmas.github.io/posts/shortened-url-by-ruby-on-rails/" /><meta property="og:url" content="https://zmerrychristmas.github.io/posts/shortened-url-by-ruby-on-rails/" /><meta property="og:site_name" content="Programmer From Zero To Mountaint" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-04-16T00:00:00+07:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="How to build a Shortened URL By Ruby On Rails like Bitly or Twitter" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@Leo đẹp trai" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Leo đẹp trai"},"dateModified":"2022-05-09T22:59:46+07:00","datePublished":"2022-04-16T00:00:00+07:00","description":"How to build a Shortened URL By Ruby On Rails like Bitly or Twitter Give a website shortenedUrl to convert longURL to short URL with alpha lexigraphy encoded/decoded response to User. Give two endpoint encoded decoded Extra default enpoint is index, and retore lasted encoded url About algorithm used on website. I use Bijective algorithm to make a alpha lexigraphy short url. Give rate limit process to request IP and prevent attack vector. I was use gem rack-attack for this case to handle limit request per IP is 5 request to 2 second. other wise, better to authentic user before they use api. To do this prevent, can implement a mechanism authentic by a system by api key for user indetify and in session. System was give an URL with a unique shortURL to decrease weight in database and open scale up if have mutilple dabase installed. To prepare for scale up: 1. Give a better cache system support Rate limit. 2. With URL was created before, we change to operation select instead create same URL. 3. Given a load ballancing to suppot this load is even better than server serve every single request. 4. Architecture from Monolith or micro service and under control of load balancing give us a good reputation. Install System Ruby version ^2.5~3.0 Rails rack-attack gem Rspec factory_bot_rails faker","headline":"How to build a Shortened URL By Ruby On Rails like Bitly or Twitter","mainEntityOfPage":{"@type":"WebPage","@id":"https://zmerrychristmas.github.io/posts/shortened-url-by-ruby-on-rails/"},"url":"https://zmerrychristmas.github.io/posts/shortened-url-by-ruby-on-rails/"}</script><meta name="pwa-cache" content="true"><title>How to build a Shortened URL By Ruby On Rails like Bitly or Twitter | Programmer From Zero To Mountaint</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Programmer From Zero To Mountaint"><meta name="application-name" content="Programmer From Zero To Mountaint"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="preconnect" href="https://polyfill.io" ><link rel="dns-prefetch" href="https://polyfill.io" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.25.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return 'mode'; } static get MODE_ATTR() { return 'data-mode'; } static get DARK_MODE() { return 'dark'; } static get LIGHT_MODE() { return 'light'; } static get ID() { return 'mode-toggle'; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia('(prefers-color-scheme: dark)'); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { document.documentElement.removeAttribute(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage( { direction: ModeToggle.ID, message: this.modeStatus }, '*' ); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.notify(); } /* flipMode() */ } /* ModeToggle */ const modeToggle = new ModeToggle(); </script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/portfolio/assets/img/portfolio/leo/horse-racing.webp" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a><h1 class="site-title"> <a href="/">Programmer From Zero To Mountaint</a></h1><p class="site-subtitle fst-italic mb-0">Programmer blog</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/portfoio/" class="nav-link"> <i class="fa-fw fas fa-paper-plane"></i> <span>PORTFOLIO</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/zmerrychristmas" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fa-brands fa-x-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['huybinh.ad','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a> <a href="https://www.linkedin.com/in/b%C3%ACnh-nguy%E1%BB%85n-75312a7b/" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>How to build a Shortened URL By Ruby On Rails like Bitly or Twitter</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1"><header><h1 data-toc-skip>How to build a Shortened URL By Ruby On Rails like Bitly or Twitter</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1650042000" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Apr 16, 2022 </time> </span> <span> Updated <time data-ts="1652111986" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > May 9, 2022 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/username">Leo đẹp trai</a> </em> </span> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="532 words" > <em>2 min</em> read</span></div></div></header><div class="content"><h1 id="how-to-build-a-shortened-url-by-ruby-on-rails-like-bitly-or-twitter">How to build a Shortened URL By Ruby On Rails like Bitly or Twitter</h1><p>Give a website shortenedUrl to convert longURL to short URL with alpha lexigraphy encoded/decoded response to User.</p><ul><li>Give two endpoint<ul><li>encoded<li>decoded</ul><li>Extra default enpoint is index, and retore lasted encoded url<li>About algorithm used on website. I use Bijective algorithm to make a alpha lexigraphy short url.<li>Give rate limit process to request IP and prevent attack vector. I was use gem <code class="language-plaintext highlighter-rouge">rack-attack</code> for this case to handle limit request per IP is 5 request to 2 second. other wise, better to authentic user before they use api. To do this prevent, can implement a mechanism authentic by a system by api key for user indetify and in session.<li>System was give an URL with a unique shortURL to decrease weight in database and open scale up if have mutilple dabase installed.<li>To prepare for scale up:<br /> 1. Give a better cache system support Rate limit.<br /> 2. With URL was created before, we change to operation select instead create same URL.<br /> 3. Given a load ballancing to suppot this load is even better than server serve every single request.<br /> 4. Architecture from Monolith or micro service and under control of load balancing give us a good reputation.</ul><h2 id="install-system"><span class="me-2">Install System</span><a href="#install-system" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Ruby version ^2.5~3.0<li>Rails<li>rack-attack gem<li>Rspec<li>factory_bot_rails<li>faker</ul><p>To install run command below:</p><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>bundle
</pre></table></code></div></div><h2 id="api-in-use"><span class="me-2">API in use</span><a href="#api-in-use" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Three enpoint with two default enpoint(<code class="language-plaintext highlighter-rouge">/api/v1/shortner/</code>):</p><ul><li>index <code class="language-plaintext highlighter-rouge">/api/v1/shortner</code>: Get method<br /> json response:<div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hello shortner"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"encoded"</span><span class="p">:</span><span class="w"> </span><span class="s2">"q"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://google.com"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><li>encoded <code class="language-plaintext highlighter-rouge">/api/v1/shortner/encoded</code>: Post method<br /> Json request:<div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://google.com"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>Json Response</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://google.com"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"decoded"</span><span class="p">:</span><span class="w"> </span><span class="s2">"b"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><li>decoded request <code class="language-plaintext highlighter-rouge">/api/v1/shortner/decoded</code>: Post method<br /> Json Request<div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"encoded"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>Json Response</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://google.com"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div></ul><h3 id="last-url-saved"><span class="me-2">Last URL saved</span><a href="#last-url-saved" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Last user saved was restore in Database. I was use default by sqlite3. But for better performance and production case need to setup dabase with MYSQL or PostgresSQL.</ul><h3 id="encoded"><span class="me-2">encoded</span><a href="#encoded" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>  <span class="k">def</span> <span class="nf">generate_slug</span>
    <span class="n">last_id</span> <span class="o">=</span> <span class="no">ShortenUrl</span><span class="p">.</span><span class="nf">last</span> <span class="p">?</span> <span class="no">ShortenUrl</span><span class="p">.</span><span class="nf">last</span><span class="p">.</span><span class="nf">id</span> <span class="p">:</span> <span class="mi">1</span>
    <span class="nb">self</span><span class="p">.</span><span class="nf">slug</span> <span class="o">=</span> <span class="no">Bijective</span><span class="p">.</span><span class="nf">bijective_encode</span><span class="p">(</span><span class="n">last_id</span><span class="p">)</span>
  <span class="k">end</span>
</pre></table></code></div></div><h3 id="decoded"><span class="me-2">decoded</span><a href="#decoded" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">url</span> <span class="o">=</span> <span class="no">ShortenUrl</span><span class="p">.</span><span class="nf">find_by_slug</span> <span class="n">params</span><span class="p">[</span><span class="ss">:encoded</span><span class="p">]</span>
<span class="n">url</span><span class="p">.</span><span class="nf">url</span>
</pre></table></code></div></div><h3 id="algorithm-to-conver-longurl-to-short"><span class="me-2">Algorithm to conver longURL to Short</span><a href="#algorithm-to-conver-longurl-to-short" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">Bijective</span>
  <span class="no">ALPHABET</span> <span class="o">=</span>
    <span class="s2">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sr">//</span><span class="p">)</span>
    <span class="c1"># make your own alphabet using:</span>
    <span class="c1"># (('a'..'z').to_a + ('A'..'Z').to_a + (0..9).to_a).shuffle.join</span>

  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">bijective_encode</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="c1"># from http://refactormycode.com/codes/125-base-62-encoding</span>
    <span class="c1"># with only minor modification</span>
    <span class="k">return</span> <span class="no">ALPHABET</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s1">''</span>
    <span class="n">base</span> <span class="o">=</span> <span class="no">ALPHABET</span><span class="p">.</span><span class="nf">length</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span>
      <span class="n">s</span> <span class="o">&lt;&lt;</span> <span class="no">ALPHABET</span><span class="p">[</span><span class="n">i</span><span class="p">.</span><span class="nf">modulo</span><span class="p">(</span><span class="n">base</span><span class="p">)]</span>
      <span class="n">i</span> <span class="o">/=</span> <span class="n">base</span>
    <span class="k">end</span>
    <span class="n">s</span><span class="p">.</span><span class="nf">reverse</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">bijective_decode</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="c1"># based on base2dec() in Tcl translation </span>
    <span class="c1"># at http://rosettacode.org/wiki/Non-decimal_radices/Convert#Ruby</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">base</span> <span class="o">=</span> <span class="no">ALPHABET</span><span class="p">.</span><span class="nf">length</span>
    <span class="n">s</span><span class="p">.</span><span class="nf">each_char</span> <span class="p">{</span> <span class="o">|</span><span class="n">c</span><span class="o">|</span> <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">base</span> <span class="o">+</span> <span class="no">ALPHABET</span><span class="p">.</span><span class="nf">index</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="p">}</span>
    <span class="n">i</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></table></code></div></div><h2 id="test-application-with-spec"><span class="me-2">Test application with Spec</span><a href="#test-application-with-spec" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Test case was specified with controller and function endoint. To run test from root of project run command:</p><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>rspec
</pre></table></code></div></div><h2 id="sumarize"><span class="me-2">Sumarize</span><a href="#sumarize" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Give a website for serve enpoint to convert long url to short url, you can find source code at my github repository.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/framework/">Framework</a>, <a href="/categories/rails/">Rails</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/rails/" class="post-tag no-text-decoration" >rails</a> <a href="/tags/api/" class="post-tag no-text-decoration" >api</a> <a href="/tags/rspec/" class="post-tag no-text-decoration" >rspec</a> <a href="/tags/shortenurl/" class="post-tag no-text-decoration" >shortenURL</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/AdHuybinh" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/alz.ailove" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=How%20to%20build%20a%20Shortened%20https%3A%2F%2Fzmerrychristmas.github.io%2Fposts%2Fshortened-url-by-ruby-on-rails%2F%20By%20Ruby%20On%20Rails%20like%20Bitly%20or%20Twitter%20-%20Programmer%20From%20Zero%20To%20Mountaint&url=https%3A%2F%2Fzmerrychristmas.github.io%2Fposts%2Fshortened-url-by-ruby-on-rails%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/in/b%C3%ACnh-nguy%E1%BB%85n-75312a7b/" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/solid-principles-and-solid-in-frameworks/">SOLID principles, and SOLID in frameworks (part 1)</a><li class="text-truncate lh-lg"> <a href="/posts/nodejs-concept/">Node.JS concept</a><li class="text-truncate lh-lg"> <a href="/posts/text-and-typography/">Text and Typography</a><li class="text-truncate lh-lg"> <a href="/posts/getting-started/">Getting Started</a><li class="text-truncate lh-lg"> <a href="/posts/enable-google-pv/">Enable Google Page Views</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/rails/">rails</a> <a class="post-tag btn btn-outline-primary" href="/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/tags/javascript/">javascript</a> <a class="post-tag btn btn-outline-primary" href="/tags/ruby/">ruby</a> <a class="post-tag btn btn-outline-primary" href="/tags/api/">api</a> <a class="post-tag btn btn-outline-primary" href="/tags/aurora/">aurora</a> <a class="post-tag btn btn-outline-primary" href="/tags/jekyll/">jekyll</a> <a class="post-tag btn btn-outline-primary" href="/tags/laravel/">laravel</a> <a class="post-tag btn btn-outline-primary" href="/tags/php/">php</a> <a class="post-tag btn btn-outline-primary" href="/tags/python/">python</a></div></section></div><section id="toc-wrapper" class="ps-0 pe-4"><h2 class="panel-heading ps-3 pt-2 mb-2">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/Tao-rails-api-voi-grape/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1616346000" data-df="ll" > Mar 22, 2021 </time><h4 class="pt-0 my-2">Tạo Rails API với Grape</h4><div class="text-muted"><p> Trong việc module hóa cũng như tạo cấu trúc REST API bạn có thể tự tạo cho mình một framework riêng hoặc sử dụng một framework đã có và đang được phát triển và ưa dùng là grape. tham khảo tại đây G...</p></div></div></a></article><article class="col"> <a href="/posts/bug-rails-gem-server-sysopen/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1616346000" data-df="ll" > Mar 22, 2021 </time><h4 class="pt-0 my-2">Bug thần thánh permission denied @ rb_sysopen</h4><div class="text-muted"><p> Bug rack/server.rb:362:in initialize: Permission denied @ rb_sysopen (Errno::EACCES) phiên bản sử dụng là rvm Try first update gem owner sudo chown -R userowner:yourgroup ~/.rvm Update permission...</p></div></div></a></article><article class="col"> <a href="/posts/cai-dat-moi-truong-ruby-on-rails-tren-ubuntu/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1616346000" data-df="ll" > Mar 22, 2021 </time><h4 class="pt-0 my-2">Cài đặt môi trường Ruby on Rails trên ubuntu 20.04</h4><div class="text-muted"><p> Cài đặt môi trường Ruby on Rails trên ubuntu Cài đặt truyền thống Ruby Để cài đặt môi trường code ruby trên ubuntu rất đơn giản vì mặc định ubuntu đã cài đặt sẵn ruby theo từng phiên bản của ubuntu...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/decoupling-ruby-on-rails-delegation-vs-dependency-injection/" class="btn btn-outline-primary" aria-label="Older" ><p>Decoupling Ruby on Rails: Delegation vs Dependency Injection</p></a> <a href="/posts/solid-principles-and-solid-in-frameworks/" class="btn btn-outline-primary" aria-label="Newer" ><p>SOLID principles, and SOLID in frameworks (part 1)</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2024</time> <a href="https://twitter.com/username">Leo đẹp trai</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/rails/">rails</a> <a class="post-tag btn btn-outline-primary" href="/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/tags/javascript/">javascript</a> <a class="post-tag btn btn-outline-primary" href="/tags/ruby/">ruby</a> <a class="post-tag btn btn-outline-primary" href="/tags/api/">api</a> <a class="post-tag btn btn-outline-primary" href="/tags/aurora/">aurora</a> <a class="post-tag btn btn-outline-primary" href="/tags/jekyll/">jekyll</a> <a class="post-tag btn btn-outline-primary" href="/tags/laravel/">laravel</a> <a class="post-tag btn btn-outline-primary" href="/tags/php/">php</a> <a class="post-tag btn btn-outline-primary" href="/tags/python/">python</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/en.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js,npm/tocbot@4.25.0/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/assets/js/dist/app.min.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-S57T0PJRJG"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-S57T0PJRJG'); }); </script> <script> /* Note: dependent library will be loaded in `js-selector.html` */ SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
